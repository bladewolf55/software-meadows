<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117916694-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-117916694-1');
  </script> <script src='http://www.softwaremeadows.com/header-scripts/prism.js'></script>
 <link rel='stylesheet' href='http://www.softwaremeadows.com/css/default.css' />
<link rel='stylesheet' href='http://www.softwaremeadows.com/css/prism.css' />
<link rel='stylesheet' href='http://www.softwaremeadows.com/css/responsive.css' />


  <title>Home | Software Meadows</title>
</head>

<body>
    <div class="row">
      <div class="col-left">
        <nav id="nav" class="nav">
          <div id="menu">
            <ol>
<li><a href="http://www.softwaremeadows.com/">Home</a></li>
<li><a href="http://www.softwaremeadows.com/about">About</a></li>
</ol>

          </div>
          <div id="recent">
            <h2>Recent</h2>
            <a href='http://www.softwaremeadows.com/posts/notes_on_improving_developer_team_practices_1'>Notes on Improving Developer Team Practices</a><a href='http://www.softwaremeadows.com/posts/using_git_locally_with_remote_tfvc'>Using Git Locally With Remote TFVC</a><a href='http://www.softwaremeadows.com/posts/raw_code_-_picture_renaming_and_sorting'>Raw Code - Picture Renaming and Sorting</a><a href='http://www.softwaremeadows.com/posts/becoming_a_professional_blogger_part_1'>Becoming a Professional Blogger Part 1</a><a href='http://www.softwaremeadows.com/posts/entity_framework_6_child_deletion_and_foreign_keys_string_int_guid'>Entity Framework 6 Child Deletion and Foreign Keys - String Int GUID</a>
          </div>
          <div id="history">
            <h2>History</h2>
            <ol class='tree'><li class='history-year'><label for='2018'>2018</label><input type='checkbox'  id='2018' /><ol><li class='history-month'><label for='2018-5'>May</label><input type='checkbox'  id='2018-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/notes_on_improving_developer_team_practices_1'>Notes on Improving Developer Team Practices</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/using_git_locally_with_remote_tfvc'>Using Git Locally With Remote TFVC</a></li></ol></li><li class='history-month'><label for='2018-4'>April</label><input type='checkbox'  id='2018-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/raw_code_-_picture_renaming_and_sorting'>Raw Code - Picture Renaming and Sorting</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/becoming_a_professional_blogger_part_1'>Becoming a Professional Blogger Part 1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/entity_framework_6_child_deletion_and_foreign_keys_string_int_guid'>Entity Framework 6 Child Deletion and Foreign Keys - String Int GUID</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/the_50-10_time_box_revising_pomodoro_for_software_development'>The 50-10 Time Box - Revising Pomodoro for Software Development</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/linqpad_-_refresh_entity_after_submitchanges_to_avoid_cached_results'>LINQPad - Refresh Entity after SubmitChanges to Avoid Cached Results</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/create_blog_post_using_markdown_monster_command_addin'>Create Blog Post Using Markdown Monster's Command Addin</a></li></ol></li><li class='history-month'><label for='2018-3'>March</label><input type='checkbox'  id='2018-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/batch_image_resize_checking_min_max_in_both_dimensions'>Batch Image Resize Checking Min Max in Both Dimensions</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/announcing_deepshadow'>Announcing DeepShadow</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a></li></ol></li><li class='history-month'><label for='2018-1'>January</label><input type='checkbox'  id='2018-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_2'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_1'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/new-blog-engine'>New Blog Engine</a></li></ol></li></ol></li><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-8'>August</label><input type='checkbox'  id='2017-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a></li></ol></li><li class='history-month'><label for='2017-7'>July</label><input type='checkbox'  id='2017-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a></li></ol></li><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-window-key-s-search-from'>Windows 8.1: Window Key + S = Search from Desktop</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li></ol>
          </div>
          <a href="javascript:void(0);" class="icon" onclick="toggleNav()">&#9776;</a>
        </nav>
      </div>
      <div class="col-right">
        <header>
          <div id="site-image">
            <img src="http://www.softwaremeadows.com/images/header.png" alt="" />
          </div>
          <h1 id="site-name"></h1>
          <div id="site-subtitle">A pleasant walk through computing</div>
        </header>
        <section id="content">
          <h1 id="home">Home</h1>

        </section>
        <!-- posts only appear in home index -->
        <section id="posts">
          
              <div class='post'>
                <h2 class='post-title'><a href='http://www.softwaremeadows.com/posts/announcing_deepshadow'>Announcing DeepShadow</a></h2>
                <p class='post-info'><span class='posted-on'>2018-03-23 18:26</span></p>
                <div class='post-content'><h2 id="an-assembly-to-help-generate-unit-test-data-from-entity-framework"><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/logo-128x128.png" alt=""> an assembly to help generate unit test data from Entity Framework</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#the-problem">The Problem</a></li>
<li><a href="#enter-deepshadow">Enter DeepShadow</a></li>
<li><a href="#masking-data">Masking Data</a></li>
<li><a href="#complete-example">Complete Example</a></li>
</ul>
<h2 id="nuget-and-source">NuGet and Source</h2>
<ul>
<li><a href="https://www.nuget.org/packages/DeepShadow">DeepShadow on NuGet</a></li>
<li><a href="https://github.com/bladewolf55/DeepShadow">DeepShadow on GitHub</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>DeepShadow helps solve a specific yet common use case: the developer needs unit test data from complex models, and wishes she could use actual data with some modifications.</p>
<p>What if she could do this?</p>
<pre><code class="language-csharp">db.Customers.Take(2).GenerateEntitiesFromList(toConsole: true);
</code></pre>
<p>or this?</p>
<pre><code class="language-csharp">File.WriteAllText("MockData.txt", db.Customers.Take(2).GenerateEntitiesFromList());
</code></pre>
<p>And get something like this?</p>
<pre><code class="language-csharp">List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();

DeepShadowDbContext.Customer a1 = new DeepShadowDbContext.Customer();
a1.CustomerId = 1;
a1.Name = @"Nicolo Paganini";
a1.Codes = new List&lt;String&gt;();
a1.Codes.Add("A1");
a1.Codes.Add("A2");
a1.Codes.Add("A3");
a1.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a1);
DeepShadowDbContext.Customer a2 = new DeepShadowDbContext.Customer();
a2.CustomerId = 2;
a2.Name = @"Hilary Hahn";
a2.Codes = new List&lt;String&gt;();
a2.Codes.Add("A1");
a2.Codes.Add("A2");
a2.Codes.Add("A3");
a2.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a2);

return list;
</code></pre>
<h2 id="the-problem">The Problem</h2>
<p>Here are relatively simple parent-child domain classes. They map to SQL tables, and the application is using Entity Framework.</p>
<pre><code class="language-csharp">    public class Customer
    {
        public int CustomerId { get; set; }
        public string Name { get; set; }
        public List&lt;string&gt; Codes {get;set;}
        //Nav
        public List&lt;Order&gt; Orders { get; set; } = new List&lt;Order&gt;();
    }

    public class Order
    {
        public int OrderId { get; set; }
        public int CustomerId { get; set; }
        public DateTime OrderedOn { get; set; }
        public decimal? Discount { get; set; }
        //Nav
        public Customer Customer { get; set; }
    }
</code></pre>
<p>You might need to test a Web API that itself calls a service. The model that comes back from the service includes related classes (i.e. Navigation Properties).</p>
<pre><code class="language-csharp">    public class CustomersController : ApiController
    {
        ICustomerService _customerService = null;

        public CustomersController(ICustomerService customerSerivce) 
        {
            _customerService = customerService
        }
        
        //GET api/customers
        public List&lt;CustomerViewModel&gt; Get()
        {
            //Returns all orders for each customer
            List&lt;Customer&gt; customers = _customerService.GetAllCustomers();
            
            List&lt;CustomerViewModel&gt; model = new List&lt;CustomerViewModel&gt;();
            
            foreach (var customer in customers)
            {
                CustomerViewModel custViewModel = new CustomerViewModel()
                {
                    //transform to the view model
                    AllCapsName = customer.Name.ToUpper();
                    CodeList = String.Join(" ", customer.Codes);
                    Orders = customer.Orders.Select(a =&gt; new OrderViewModel() 
                    {
                      //likewise transform orders to the view model  
                    });
                }
                model.Add(custViewModel);
            }
            return Content(model);
        }
    }
</code></pre>
<p>You're not testing the service, but you need to be sure that the Customer/Order properties map correctly to the View Model properties. You don't want to find out in production you set the CustomerViewModel.CodeList property to Customer.Name.</p>
<p>A simplistic unit test might look like this (NOT a working example!):</p>
<pre><code class="language-csharp">    
    [TestMethod]
    public void TestMethod1()
    {
        ICustomerService mockService = new MockCustomerService();
        mockService.TestCustomers = MockData.CustomersAndOrders;
        var controller = new CustomersController(mockService);
        var actual = controller.Get();
        Assert.AreEqual(mockService.TestCustomers.Count(), actual.Count());
    }
</code></pre>
<p>The mock service could be as simple as this, if you didn't want to use a mocking framework. Each test can set what customers/orders it wants to use.</p>
<pre><code class="language-csharp">    
    public class CustomerSerivce: ICustomerService
    {
        public List&lt;Customer&gt; TestCustomers {get; set;}
        
        public List&lt;Customer&gt; GetAllCustomers() 
        {
            return TestCustomers;
        }
    }
    
</code></pre>
<p>So, great, but what about the actual test data? In many cases, it's OK to hand-craft what you need, like this:</p>
<pre><code class="language-csharp">    Customer customer = new Customer()
    {
        CustomerId = 1,
        Name = "blamo",
        Codes = new List&lt;string&gt; {"a","b"},
        Orders = new List&lt;Order&gt;()
        {
            new Order()
            {
                OrderId = 11,
                CustomerId = 1,
                OrderedOn = DateTime.Parse("1/1/2001"),
                Discount = 10.00m,
                Customer = this
            }
        }
    }
</code></pre>
<p>But what if you have classes with twenty or thirty properties? And what if those properties have some domain-specific data or formats that need careful testing?</p>
<pre><code>Customer.ID = {820bd7ae-fed3-419f-b778-8a817b45a968}
Customer.Name = Lewellen-Taft-O'Brien Marketing, LLC.
Customer.DiscountMatrix = 15.00|13.25|10.973
etc.
</code></pre>
<p>It's both tedious and error-prone to fabricate values like that when excellent test data is <em>right there in the database</em>! And, you already have code in the service to return that data. You just want to generate code to recreate the data in memory.</p>
<h2 id="enter-deepshadow">Enter DeepShadow</h2>
<p>With DeepShadow, you can potentially generate your models as simply as this:</p>
<pre><code class="language-csharp">//This is an Entity Framework DbContext
MyDb db = new MyDb();

//REQUIRED FOR Mock Data Generation
db.Configuration.ProxyCreationEnabled = false;

//Generate a list of models
db.Customers.Take(5).GenerateEntitiesFromList(toConsole: true);

//Generate from a single entity
db.Customers.First().GenerateEntitiesFromObject(toConsole: true);
</code></pre>
<p>The output will look like this:</p>
<pre><code class="language-csharp">List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();

DeepShadowDbContext.Customer a1 = new DeepShadowDbContext.Customer();
a1.CustomerId = 1;
a1.Name = @"Nicolo Paganini";
a1.Codes = new List&lt;String&gt;();
a1.Codes.Add("A1");
a1.Codes.Add("A2");
a1.Codes.Add("A3");
a1.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a1);
DeepShadowDbContext.Customer a2 = new DeepShadowDbContext.Customer();
a2.CustomerId = 2;
a2.Name = @"Hilary Hahn";
a2.Codes = new List&lt;String&gt;();
a2.Codes.Add("A1");
a2.Codes.Add("A2");
a2.Codes.Add("A3");
a2.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a2);

return list;
</code></pre>
<p>You'd put the above in some kind of unit testing MockData class, which is used to set the mock service method's return value.</p>
<pre><code class="language-csharp">public static class MockData
{
    public static List&lt;Customer&gt; CustomersAndOrders
    {
        get {
            List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();
            //data
            return list;
        }
    }
}
</code></pre>
<h2 id="masking-data">Masking Data</h2>
<p>Often you'll want to retrieve data from your database, but obscure sensitive data. That's easy enough in most cases without any help from DeepShadow.</p>
<pre><code class="language-csharp">//This is an Entity Framework DbContext
MyDb db = new MyDb();

//REQUIRED FOR Mock Data Generation
db.Configuration.ProxyCreationEnabled = false;

var employees = db.Employees.Where(a =&gt; a.Inactive == true).ToList();

//mask data
foreach (var employee in employees )
{
    employee.SSN = "111-22-3456";
    employee.DateOfBirth = DateTime.Parse("1/1/2001");
}

//Generate a list of models
employees.GenerateEntitiesFromList(toConsole: true);

</code></pre>
<h2 id="complete-example">Complete Example</h2>
<p>I use (and recommend) the registered version of <a href="http://www.linqpad.net/">LINQPad</a> for generating the data, though you could also create a console app to do it. The code's almost exactly the same. In this example, I've created a SQL database named DeepShadowSample, and a console application with an Entity Framework DbContext named DeepShadowDb.</p>
<blockquote>
<p><strong>Important</strong><br>
If you're using LINQPad, you must have a registered version in order to easily install the NuGet package.</p>
</blockquote>
<h4 id="table-schema-and-data">Table Schema and Data</h4>
<pre><code class="language-sql">create table Customers
(
	CustomerId int not null primary key,
	Name varchar(max)
)

create table Codes
(
	Id int identity primary key,
	Name varchar(max)
)

create table Orders
(
	OrderId int not null primary key,
	CustomerId int not null foreign key references Customers(CustomerId),
	OrderedOn datetime not null,
	Discount decimal null
)


insert Customers select 1, 'Nicolo Paganini'
insert Customers select 2, 'Jasha Heifetz'
insert Customers select 3, 'Erica Morini'
insert Customers select 4, 'Hilary Hahn'

insert Orders select 2, 1, '2001-01-01', 10
insert Orders select 3, 2, '2002-01-01', 0
insert Orders select 4, 2, '2002-02-02', 5
insert Orders select 5, 3, '2012-05-23', 0
insert Orders select 6, 3, '2012-05-23 12:00:00.000', NULL
insert Orders select 7, 3, '2012-05-24', 0
insert Orders select 9, 4, '2015-12-12', NULL
insert Orders select 10, 4, '2017-12-15', 3

insert Codes (Name) values ('A1,A2,A3')
insert Codes (Name) values ('B4,B7')
</code></pre>
<h4 id="deepshadowdbcontext-console-app">DeepShadowDbContext Console App</h4>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Data.Entity;

namespace DeepShadowDbContext
{
    class Program
    {
        static void Main(string[] args)
        {            
            var service = new CustomerService(new DeepShadowDb());
            Console.WriteLine(service.GetAllCustomers().Count()); //should return 4
            Console.ReadLine();
        }
    }

    public class CustomerService
    {
        DeepShadowDb _db;

        public CustomerService(DeepShadowDb db)
        {
            _db = db;
        }

        public List&lt;Customer&gt; GetAllCustomers()
        {
            var customers = _db.Customers.ToList();
            var codes = _db.Codes.First();
            foreach (var customer in customers)
            {
                customer.Codes = codes.Name.Split(',').ToList();
            }
            return customers;
        }
    }

    public class Customer
    {
        public int CustomerId { get; set; }
        public string Name { get; set; }
        public List&lt;string&gt; Codes { get; set; }
        //Navigation
        public List&lt;Order&gt; Orders { get; set; } = new List&lt;Order&gt;();
    }

    public class Order
    {
        public int OrderId { get; set; }
        public int CustomerId { get; set; }
        public DateTime OrderedOn { get; set; }
        public decimal? Discount { get; set; }
        //Navigation
        public Customer Customer { get; set; }
    }

    public class Code
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    public class DeepShadowDb : DbContext
    {
        public DbSet&lt;Customer&gt; Customers { get; set; }
        public DbSet&lt;Order&gt; Order { get; set; }
        public DbSet&lt;Code&gt; Codes { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;Customer&gt;().Ignore(a =&gt; a.Codes);
        }
    }
}
</code></pre>
<h4 id="app.config">App.Config</h4>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;configSections&gt;
  &lt;/configSections&gt;
  &lt;startup&gt;
    &lt;supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" /&gt;
  &lt;/startup&gt;
  &lt;connectionStrings&gt;
    &lt;add name="DeepShadowDb" 
         connectionString="Server=.\SQLEXPRESS2016;Database=DeepShadowSample;Trusted_Connection=True;"
         providerName="System.Data.SqlClient"/&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;
</code></pre>
<h4 id="open-linqpad-to-a-new-c-statements-query">1. Open LINQPad to a new C# Statements query</h4>
<h4 id="add-entity-framework-connection">2. Add Entity Framework connection</h4>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_19_33.png" alt=""></p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_22_32.png" alt=""></p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_23_55.png" alt=""></p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_27_14.png" alt=""></p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_30_01.png" alt=""></p>
<h4 id="set-the-query-connection">3. Set the query connection</h4>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_31_44.png" alt=""></p>
<h4 id="press-f4-to-open-the-query-settings-and-click-add-nuget">4. Press F4 to open the query settings, and click Add NuGet</h4>
<h4 id="search-online-for-deepshadow-and-add-to-query">5. Search online for DeepShadow, and add to query</h4>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_36_34.png" alt=""></p>
<h4 id="in-the-query-properties-window-additional-namespace-imports-tab-click-pick-from-assemblies-and-add-the-deepshadow-namespace">6. In the Query Properties window, Additional Namespace Imports tab, click Pick from assemblies and add the <code>DeepShadow</code>  namespace.</h4>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_42_34.png" alt=""></p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_41_19.png" alt=""></p>
<h4 id="in-the-query-window-add-this-code.notice-how-its-essentially-copypaste-from-customerservice.getallcustomers">7. In the query window, add this code. Notice how it's essentially copy/paste from <code>CustomerService.GetAllCustomers</code>.</h4>
<pre><code class="language-csharp">DeepShadowDb _db = this;

//REQUIRED FOR Mock Data Generation
_db.Configuration.ProxyCreationEnabled = false;
//_db.Database.Connection.ConnectionString.Dump();
//////////////////

//This is the code copied from the supposed CustomerService.GetAllCustomers method
//Note that the service does some data manipulation by setting Codes from another table.

var customers = _db.Customers.ToList();
var codes = _db.Codes.First();
foreach (var customer in Customers)
{
    customer.Codes = codes.Name.Split(',').ToList();
}
//This generates the code
customers.GenerateEntitiesFromList(toConsole: true);

</code></pre>
<h4 id="the-result">8. The result</h4>
<pre><code class="language-csharp">List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();

DeepShadowDbContext.Customer a1 = new DeepShadowDbContext.Customer();
a1.CustomerId = 1;
a1.Name = @"Nicolo Paganini";
a1.Codes = new List&lt;String&gt;();
a1.Codes.Add("A1");
a1.Codes.Add("A2");
a1.Codes.Add("A3");
a1.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a1);
DeepShadowDbContext.Customer a2 = new DeepShadowDbContext.Customer();
a2.CustomerId = 2;
a2.Name = @"Jasha Heifetz";
a2.Codes = new List&lt;String&gt;();
a2.Codes.Add("A1");
a2.Codes.Add("A2");
a2.Codes.Add("A3");
a2.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a2);
DeepShadowDbContext.Customer a3 = new DeepShadowDbContext.Customer();
a3.CustomerId = 3;
a3.Name = @"Erica Morini";
a3.Codes = new List&lt;String&gt;();
a3.Codes.Add("A1");
a3.Codes.Add("A2");
a3.Codes.Add("A3");
a3.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a3);
DeepShadowDbContext.Customer a4 = new DeepShadowDbContext.Customer();
a4.CustomerId = 4;
a4.Name = @"Hilary Hahn";
a4.Codes = new List&lt;String&gt;();
a4.Codes.Add("A1");
a4.Codes.Add("A2");
a4.Codes.Add("A3");
a4.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a4);

return list;
</code></pre>
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='http://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a></h2>
                <p class='post-info'><span class='posted-on'>2018-03-19 12:03</span></p>
                <div class='post-content'><h1 id="deftconfig"><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/juggler-100x100.png" alt=""> DeftConfig</h1>
<blockquote>
<p>Web.config and app.config shouldn't be stored. They should be generated. DeftConfig helps with that.</p>
</blockquote>
<p><a href="https://www.nuget.org/packages/DeftConfig/">NuGet Package</a></p>
<p><a href="https://github.com/bladewolf55/DeftConfig">GitHub Repository</a></p>
<h2 id="briefly">Briefly</h2>
<p>The .Net configuration story has never been particularly good. It's improving significantly in .Net Core, but there's a lot of .Net Framework code that's built and going to be built.</p>
<p>The fundamental problems with .Net Framework config files are:</p>
<ol>
<li>They require a physical file. A configuration can't be created in memory.</li>
<li>They don't work well with multiple environments, even using XML Transformations as intended.</li>
<li>They don't lend themselves to managing sensitive settings such as passwords, especially in a Continuous Integration environment.</li>
</ol>
<p>DeftConfig makes it easier to use the "base config" approach to managing configuration files using XML Transformations. It follows a convention for how it finds the transformation file.</p>
<ol>
<li>Look for a file in the format <code>web(or app).base.[Configuration].config</code>. Example: web.base.Release.config</li>
<li>Check the user profile's <code>%APPDATA%\DeftConfig\{Project GUID}</code> folder</li>
<li>Check the project folder</li>
<li>If not found, use web/app.base.Sample.config</li>
</ol>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/deft-config-flow.png" alt=""></p>
<p>This approach allows for storing a production config, with sensitive settings, in a Windows Continuous Integration server's appropriate user profile rather than version control. The server folder can be restricted via permissions.</p>
<p>It also allows multiple developers to have their own, local Debug config; it also doesn't get stored in source control.</p>
<p>Finally, DeftConfig recommends maintaining a sample config that will help new developers understand what configurations need to be changed, and can provide a safe, default working experience.</p>
<p>The package is just two components:</p>
<ol>
<li>An MSBuild targets file that applies the transformation and outputs the .config file.</li>
<li>A utility to help configure the project, including adding an <code>.ignore</code> file for either Git or TFVC.</li>
</ol>
<blockquote>
<p><strong>Important</strong><br>
I don't guarantee DeftConfig will work in your environment. You need to take the right steps to protect your source code, including backups, version control, and testing.</p>
</blockquote>
<h2 id="goals">Goals</h2>
<p>DeftConfig achieves several goals. Web.config is used in the examples below, but DeftConfig applies equally to app.config.</p>
<ol>
<li>Don't store web.config or web.Debug/Release.config in source control.</li>
<li>Don't store web.Debug.config in source control, allow independent developer configurations.</li>
<li>Use web.base.config file for XmlTransform source, and apply web.base.[Configuration].config transform file.</li>
<li>Make Windows-based Continuous Integration easier and more secure by searching for transform files in a user profile folder first, then in the project file.</li>
<li>Make it easier for new developers to use non-destructive settings.</li>
</ol>
<h2 id="cons">Cons</h2>
<p>All isn't lemonade and corn dogs when using DeftConfig. There are a few challenges that you need to be aware of.</p>
<ol>
<li>NuGet packages often modify the web.config file (EntityFramework, for example). It will be critical for developers who add packages to copy any changes from the local web.config into web.base.config.</li>
<li>If you change <em>only</em> one of the config files, then do a standard build (F6), web.config won't be updated. You'll need to do a Rebuild. (This is not an issue with TFS Build server, which always does a rebuild).</li>
</ol>
<h2 id="installation">Installation</h2>
<ol>
<li>Install the NuGet package. This adds the DeftConfig.targets file, and an executable named DeftConfigInitializer is copied to the project root folder.</li>
<li>Run DeftConfigInitializer, which will
<ol>
<li>Create a user profile folder for config files, if desired.</li>
<li>Convert existing *.config files to use the *.base.config method.</li>
<li>Add a .gitignore or .tfignore file so that the standard *.config files are ignored by default.</li>
</ol>
</li>
<li>Delete DeftConfigInitializer, if desired.</li>
</ol>
<p>Typical project files before DeftConfig</p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/2018-03-15%2019_49_52.png" alt=""></p>
<p>and after running DeftConfigInitializer</p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/2018-03-15%2019_53_20.png" alt=""></p>
<p>The Debug and Release configs are still in the project folder, except they've been converted to "base" files.</p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/2018-03-15%2019_55_47.png" alt=""></p>
<h2 id="files">Files</h2>
<p>Any settings that were previously in web.config are now in web.base.config.</p>
<p>Here are the recommended way of using the files, with an example. The original web.config had these appSettings. Notice that the production and dev credentials are being stored. Developers have been commenting/uncommenting.</p>
<pre><code class="language-xml">&lt;/appSettings&gt;
    &lt;add key="CustomizationVersion" value="HGC1234" /&gt;
    &lt;!--
    &lt;add key="WebServiceUser" value="dev-user"/&gt;
    &lt;add key="WebServicePassword" value="DevPass"/&gt;
    --&gt;
    &lt;add key="WebServiceUser" value="production-admin"/&gt;
    &lt;add key="WebServicePassword" value="Pr0ductionPassw0rd!"/&gt;
&lt;/appSettings&gt;
</code></pre>
<h3 id="web.base.config">web.base.config</h3>
<p>The base config should retain values that are <em>not</em> transformed, and shouldn't have values for settings that will be tranformed. This is also a good place to document the settings. Copy those credential appSettings elsewhere, we'll need them later.</p>
<pre><code class="language-xml">&lt;/appSettings&gt;
    &lt;!-- Don't change: It's specific to this client --&gt;
    &lt;add key="CustomizationVersion" value="HGC1234" /&gt;
    &lt;!-- Credentials for the 3rd party web service --&gt;
    &lt;add key="WebServiceUser" value=""/&gt;
    &lt;add key="WebServicePassword" value="" /&gt;
&lt;/appSettings&gt;
</code></pre>
<h3 id="web.base.sample.config">web.base.Sample.config</h3>
<p>The Sample config file <em>is</em> stored in source control. It acts as a default configuration. If a Configuration (Debug/Release) config file can't be found, the Sample will be used. These could be default values for a developer, or dummy values.</p>
<pre><code class="language-xml">&lt;/appSettings&gt;
    &lt;add key="WebServiceUser" value="user" xdt:Locater="Match(key)" xdt:Transform="Replace"/&gt;
    &lt;add key="WebServicePassword" value="pass" xdt:Locater="Match(key)" xdt:Transform="Replace"/&gt;
&lt;/appSettings&gt;
</code></pre>
<h3 id="web.base.debug.config">web.base.Debug.config</h3>
<p>The Debug file is for developer settings. Since it's not stored in source control, each developer can have her own settings.</p>
<pre><code class="language-xml">&lt;/appSettings&gt;
    &lt;add key="WebServiceUser" value="dev-user" xdt:Locater="Match(key)" xdt:Transform="Replace"/&gt;
    &lt;add key="WebServicePassword" value="DevPass" xdt:Locater="Match(key)" xdt:Transform="Replace"/&gt;
&lt;/appSettings&gt;
</code></pre>
<h3 id="web.base.release.config">web.base.Release.config</h3>
<p>Like the Debug file, the Release file is also not stored in source control. As shown below, if using a Windows-based continuous build system, it will be stored in the user profile of the automated build agent. This keeps sensitive credentials out of source control.</p>
<pre><code class="language-xml">&lt;/appSettings&gt;
    &lt;add key="WebServiceUser" value="production-admin" xdt:Locater="Match(key)" xdt:Transform="Replace"/&gt;
    &lt;add key="WebServicePassword" value="Pr0ductionPassw0rd!" xdt:Locater="Match(key)" xdt:Transform="Replace"/&gt;
&lt;/appSettings&gt;
</code></pre>
<h2 id="building-a-configuration">Building a Configuration</h2>
<p>As noted above, the safest way to build is to right-click the Solution and choose Rebuild. But in most cases you'll be able to just F6 or F5.</p>
<p>Which configuration is used is determined by the selected Configuration.</p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/2018-03-15%2020_33_46.png" alt=""></p>
<p>Many development shops have a separate testing or staging environment. To configure that with DeftConfig, you'd simply add the configuration such as "Stage" using Configuration Manager, then manually create the web.base.Stage.config transform file (probably using copy/paste).</p>
<h2 id="where-and-how-transform-files-are-searched">Where and How Transform Files are Searched</h2>
<p>The initializer utility will optionally create a folder in the user's profile. The folder is named using the project's GUID, since the project name could change. The path is:</p>
<p><code>C:\Users\[user]\AppData\Roaming\DeftConfig\{PROJECT GUID}</code></p>
<blockquote>
<p>Strictly speaking, the path is <code>%AppData%\DeftConfig\{PROJECT GUID}</code></p>
</blockquote>
<p>The DeftConfig build target checks for a matching config file in the following order. The diagram assumes the Release configuration is being built for MyAppProject.</p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/deft-config-file-order.png" alt=""></p>
<h2 id="why-isnt-web.config-removed-from-the-project">Why Isn't Web.config Removed From the Project?</h2>
<p>Only files that are part of the project (that is, they're in the .csproj or .vsproj file) will be copied when using the project's Publish feature.</p>
<pre><code class="language-xml">  &lt;ItemGroup&gt;
    &lt;Content Include="DeftConfigInitializer.exe" /&gt;
    &lt;Content Include="Web.config" /&gt;
    &lt;None Include="Web.base.config" /&gt;
    &lt;None Include="Web.base.Sample.config" /&gt;
  &lt;/ItemGroup&gt;
</code></pre>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/2018-03-15%2021_12_47.png" alt=""></p>
<p>However, just because there's an entry in the project file for web.config doesn't mean it <em>has</em> to be in the folder when you get the code from source control. It just has to be there when Publish is run.</p>
<p>This is why I recommend adding web.config to a Git or TFS ignore file in the project folder. Web.config will always be created as part of the build process, so it doesn't need to be stored in source control.</p>
<p><img src="http://www.softwaremeadows.com/posts/announcing_deftconfig/images/2018-03-15%2021_19_52.png" alt=""></p>
<p>DeftConfigInitializer will do this automatically if you choose.</p>
<p><strong>Using Git</strong></p>
<pre><code># Visual Studio 2015 Note: a pattern in the first line is ignored by Changes. Visual Studio Bug.
# DeftConfig - Ignore/allow certain config files when using *.base.[Build].config transform method

/[Ww]eb.config
/[Ww]eb.*.config
!/[Ww]eb.[Bb]ase.config
!/[Ww]eb.[Bb]ase.[Ss]ample.config

/[Aa]pp.config
/[Aa]pp.*.config
!/[Aa]pp.[Bb]ase.config
!/[Aa]pp.[Bb]ase.[Ss]ample.config
</code></pre>
<p><strong>Using TFVS</strong></p>
<pre><code>#TFVS Ignore

\Web.config
\Web.*.config
!\Web.base.config
!\Web.base.Sample.config

\App.config
\App.*.config
!\App.base.config
!\App.base.Sample.config
</code></pre>
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a></h2>
                <p class='post-info'><span class='posted-on'>2018-01-07 14:49</span></p>
                <div class='post-content'><p><img src="http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy/images/tfs-logo.png" alt=""> <img src="http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy/images/robocopy-command.gif" alt=""></p>
<br>
<p>Team Foundation Server 2015 Update 2 includes Release Management. However, I found myself in a position where a client hadn't upgraded yet, and during development I still wanted to publish ASP.NET MVC and WebApi projects to a test server. I did this through a combination of Build tasks running the msbuild publish command line, and Robocopy.</p>
<p>Also, while TFS Build includes steps for staging artifacts, an ASP.NET project doesn't simply move all files to a bin folder. Many files are taken directly from the project source folders, requiring me to use the MSBuild Publish command line switches.</p>
<h1 id="the-tfs-build-definition">The TFS Build Definition</h1>
<p>In my Build, I'm going to do the following steps:</p>
<ol>
<li>Get the source code</li>
<li>Get the NuGet packages</li>
<li>Build and Test &lt;= <strong>if anything fails up to this point, I don't want to publish</strong></li>
<li>Use msbuild to publish locally (to the Build agent workspace)</li>
<li>Use Robocopy to copy the files to another computer running IIS</li>
</ol>
<p>The first three steps are pretty standard, so I won't cover them. If you don't know how to set up a build, you'll need to read up on that. The last two are the fun ones.</p>
<p><img src="http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy/images/2018-01-07%2015_56_14.png" alt=""></p>
<h1 id="publishing-asp.net-from-command-line">Publishing ASP.NET from command line</h1>
<p>In Visual Studio, it's easy (and nice) to publish an ASP.NET project to the file system. But what if you want to publish in an ad-hoc manner? It can be done, but the info is hard-won.</p>
<pre><code>msbuild ProjectFile.csproj /p:Configuration=Release ^
                           /p:Platform=AnyCPU ^
                           /t:WebPublish ^
                           /p:WebPublishMethod=FileSystem ^
                           /p:DeleteExistingFiles=True ^
                           /p:publishUrl=c:\output
                           
Or if you are building the solution file:

msbuild Solution.sln /p:Configuration=Release ^ 
                     /p:DeployOnBuild=True ^
                     /p:DeployDefaultTarget=WebPublish ^
                     /p:WebPublishMethod=FileSystem ^
                     /p:DeleteExistingFiles=True ^
                     /p:publishUrl=c:\output
</code></pre>
<p>In my Build definition, I add a Visual Studio Build step. (I could probably also use an MS Build step, but I haven't tested that.)</p>
<p>In the Solution field, enter the path to the web <em>project</em> you're going to build. The MSBuild Arguments are shown below. Note the variables used for both the build configuration and the destination folder. I'm publishing locally first.</p>
<p><code>/p:Configuration=$(BuildConfiguration) /p:DeployOnBuild=True /p:DeployDefaultTarget=WebPublish /p:WebPublishMethod=FileSystem /p:publishUrl="$(build.artifactstagingdirectory)\deploy\web"</code></p>
<blockquote>
<p><strong>Note</strong><br>
If I was also publishing a WebApi project in the same definition, I'd have a separate build step, and the publishUrl might be <code>$(build.artifactstagingdirectory)\deploy\api</code></p>
</blockquote>
<p><img src="http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy/images/2018-01-07%2015_45_51.png" alt=""></p>
<h1 id="copy-the-site-to-its-destination-using-robocopy">Copy the site to its destination using Robocopy</h1>
<p>Why am I not using the publishUrl, above, to publish to the destination server? In many cases, I could, and that's fine. But what if I expect a destination file to be in use, and isn't normally updated? For example, I had a site using the NHunspell.dll. That file would often be in use, and wasn't changing. If I used publishUrl, the publish would always fail.</p>
<p>Microsoft's <a href="https://technet.microsoft.com/en-us/library/cc733145(v=ws.11).aspx">Robocopy</a> ("Robust Copy"), included in all Windows editions, will skip and retry files it can't copy. This will still show as an error, but I'll set the step to "continue on error". It's not a perfect solution, but fine for many environments.</p>
<p>Add a Command Line step to the definition.</p>
<ul>
<li>Tool = robocopy.exe</li>
<li>Arguments = <code>"$(build.artifactstagingdirectory)\deploy\web" "\\iis-server\wwwroot$\my-web-site" /e /r:2 /w:5</code></li>
</ul>
<p><img src="http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy/images/2018-01-07%2015_55_48.png" alt=""></p>
<p>The Robocopy arguments say:</p>
<ol>
<li>Copy from the local deploy\web folder to the remote server folder</li>
<li><code>/e</code> = Copies subdirectories. Note that this option includes empty directories.</li>
<li><code>/r:2</code> = Retry busy files twice.</li>
<li><code>/w:5</code> = Wait five seconds between retry attempts.</li>
</ol>
<p>When the step runs, Robocopy outputs a nice report of what happened, very useful when viewing the build log.</p>
<h1 id="wrap-up">Wrap Up</h1>
<p>While not ideal, the above is a useful workaround for publishing ASP.NET build artifacts to a remote machine. It also shows the flexibility that can be obtained through using other tools.</p>
<h1 id="references">References</h1>
<p><a href="https://stackoverflow.com/a/20982171/1628707">How to use MsBuild MsDeployPublish to target local file system?</a></p>
<p><a href="https://www.benday.com/2016/09/08/an-asp-net-mvc-site-thats-easy-to-deploy-from-a-tfs-build/">An ASP.NET MVC Site That’s Easy to Deploy from a TFS Build</a></p>
<p><a href="https://technet.microsoft.com/en-us/library/cc733145(v=ws.11).aspx">Robocopy</a></p>
</div>
              </div>
               <div class='paging'><a href='index2.html'>Newer</a>&nbsp;&nbsp;&nbsp;<a href='index4.html'>Older</a></div>
        </section>
        <footer><p>Copyright (c) 2018 Charles L Flatt</p>
</footer>
      </div>
    </div>
    
    <script>
    function toggleNav() {
      var x = document.getElementById("nav");
      if (x.className === "nav") {
          x.className += " responsive";
      } else {
          x.className = "nav";
      }
  }</script>
  </body>

</html>