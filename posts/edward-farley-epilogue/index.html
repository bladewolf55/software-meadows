<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <link rel='stylesheet' href='http://www.softwaremeadows.com/css/default.css' />
<link rel='stylesheet' href='http://www.softwaremeadows.com/css/tango.css' />

  <title>Edward Farley And The Fantastic Library Epilogue | Software Meadows</title>
</head>

<body>
  <nav>
    <div id="menu">
      <ol>
<li><a href="http://www.softwaremeadows.com/">Home</a></li>
<li><a href="http://www.softwaremeadows.com/about">About</a></li>
</ol>

    </div>
    <div id="recent">
      <h2>Recent</h2>
      <a href='http://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a><a href='http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a><a href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_2'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 2</a><a href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_1'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 1</a><a href='http://www.softwaremeadows.com/posts/new-blog-engine'>New Blog Engine</a>
    </div>
    <div id="history">
      <h2>History</h2>
      <ol class='tree'><li class='history-year'><label for='2018'>2018</label><input type='checkbox'  id='2018' /><ol><li class='history-month'><label for='2018-3'>March</label><input type='checkbox'  id='2018-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a></li></ol></li><li class='history-month'><label for='2018-1'>January</label><input type='checkbox'  id='2018-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_2'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_1'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/new-blog-engine'>New Blog Engine</a></li></ol></li></ol></li><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-8'>August</label><input type='checkbox'  id='2017-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a></li></ol></li><li class='history-month'><label for='2017-7'>July</label><input type='checkbox'  id='2017-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a></li></ol></li><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-window-key-s-search-from'>Windows 8.1: Window Key + S = Search from Desktop</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li></ol>
    </div>
  </nav>
  <header>
    <div id="site-image">
      <img src="http://www.softwaremeadows.com/images/header.png" alt="" />
    </div>
    <h1 id="site-name"></h1>
    <div id="site-subtitle">A pleasant walk through computing</div>
  </header>
  <section id="content">
    
              <div class='post'>
                <h2 class='post-title'><a href='http://www.softwaremeadows.com/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></h2>
                <p class='post-info'><span class='posted-on'>2013-09-05 18:49</span></p>
                <div class='post-content'><div class="series">

<p>Parts <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1.html">1) Preface</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-2.html">2) Introduction</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-3.html">3) A Simple Table</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-4.html">4) One to One or Many</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-5.html">5) Zero or One to Zero or Many</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-6.html">6) One to Zero or Many</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-7.html">7) One to Zero or One</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-8.html">8) One to One</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-9.html">9) Many to Many, Simple</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-10.html">10) Many to Many with Payload</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1019.html">11) Enumerables</a> <a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-12.html">12) Inheritance</a></p>
</div>

<p><a href="https://drive.google.com/folderview?id=0B9XcO7NbiPZcc29IZDVIN2kzZDQ&amp;usp=sharing">Source Code</a></p>
<h2 id="entity-framework-5-code-first-relationships">Entity Framework 5 Code First Relationships</h2>
<h3 id="many-to-many-with-payload-and-one-to-many">Many to Many With Payload and One to Many</h3>
<p><em>Edward learns what his mother knows.</em></p>
<p>Edward Farley put his new hover tablet down in disgust. "Mom, I can't get it to work!"</p>
<p>His mother came in from her office/studio. "Which 'it' would that be, dear?"</p>
<p>"Umbrella covers!"</p>
<p>"Ah," said his mother. "This is the puzzle Professor Relvar sent you, after he received your thank you card for the tablet?"</p>
<p>"Yes," mumbled Edward, miserably. "I thought I could figure it out. I guess I'll have to ask him."</p>
<p>"Edward, I realize I'm not at brilliant as Professor Relvar, but I do know a thing or two about databases and the Framework. Would you like my help?"</p>
<p>"I guess so."</p>
<p>She smiled and sat next to him. "I think the Professor would say something like, 'Now, young man, what seems to be your trouble? I assure you it isn't my trouble, though I may trouble myself to help you.'"</p>
<p>Edward stared at his mother. "That sounded just like him."</p>
<p>"Well, then," she continued, "explain the problem."</p>
<p>"I have umbrellas. An umbrella could be used by many people, and a person could use many umbrellas."</p>
<p>"A Many to Many relationship," said his mother.</p>
<p>"Right. Except an umbrella for a person becomes a color. So, it's a Many to Many with Payload. Now I want to show that an umbrella-person combination can have many umbrella covers. The Professor said I could use the join table's UmbrellaId and PersonId columns as the key, but he said there was another way and I don't remember."</p>
<p>"May I use your tablet?" his mother asked. Edward handed it to her. She pressed several buttons and the tablet projected its screen on a far wall.</p>
<p>What you are trying to do, Edward, [his mother continued], is keep your table primary keys simple. It's nice to not use composite keys unless you have to, because it's easier to relate tables using a single column. Instead of starting at the beginning, let's start at the end. Here's how you want the tables to look.</p>
<div class="separator" style="clear: both; text-align: center;">

<p><a href="images/Many%20to%20Many%20Payload2.png"><img src="http://www.softwaremeadows.com/posts/edward-farley-epilogue/images/Many%20to%20Many%20Payload2.png"></a></p>
</div>

<p>It's easy to add a new primary key to the class. And if we remove the attributes that tell PersonId and UmbrellaId that they're part of the key, the Framework will still see them as foreign keys because they're named according to convention. Otherwise, you'd have to use attributes on the navigation properties to indicate the foreign key property.</p>
<p>Let's also add the related PersonUmbrellaCovers class. Now, you understand, dear, that this isn't a practical thing to do? Having an umbrella cover for each unique person-umbrella? But, the Professor does love his little puzzles. Here is how our classes will look.</p>
<p><strong>LearningEFSchema.cs</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">public</span> <span class="kw">class</span> PersonUmbrella</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">//Primary Key</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">public</span> <span class="dt">int</span> PersonUmbrellaId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">//Unique Key (aka candidate key, could have been primary key)</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">//must be handled in DbContext.ValidateEntity.</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">//Foreign Keys</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">public</span> <span class="dt">int</span> PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">public</span> <span class="dt">int</span> UmbrellaId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">[Required]</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">public</span> UmbrellaColors Color { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">//Navigation</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">public</span> <span class="kw">virtual</span> Person Person { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">public</span> <span class="kw">virtual</span> Umbrella Umbrella { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;PersonUmbrellaCover&gt; PersonUmbrellaCovers { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">public</span> <span class="fu">PersonUmbrella</span>()</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">{</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">PersonUmbrellaCovers = <span class="kw">new</span> HashSet&lt;PersonUmbrellaCover&gt;();</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb1-24" data-line-number="24"></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="kw">public</span> <span class="kw">class</span> PersonUmbrellaCover</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">{</a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">//Primary Key</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="kw">public</span> <span class="dt">int</span> PersonUmbrellaCoverId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">//Foreign Key</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="kw">public</span> <span class="dt">int</span> PersonUmbrellaId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-31" data-line-number="31"></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">[Required]</a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="kw">public</span> <span class="dt">string</span> Description { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">//Navigation</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="kw">public</span> <span class="kw">virtual</span> PersonUmbrella PersonUmbrella { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb1-37" data-line-number="37"></a>
<a class="sourceLine" id="cb1-38" data-line-number="38">}</a></code></pre></div>
<p>Let's not update the program's output yet, and just run it so we see how the database turns out. [She did so, and they viewed the tables] See? We have the tables we wanted. Now, dear, are we finished?</p>
<p>[Edward thought hard, then shook his head. "Couldn't we have duplicate PersonUmbrellas?"]</p>
<p>Exactly! I'll have to tell you father you really were paying attention to the Professor, and not just eating ice cream. Our problem is that by no longer setting the PersonId and UmbrellaId columns as part of a key, they aren't guaranteed to be unique. We need to do something similar to your Magnifier serial number problem. In your DbContext class, we'll add a uniqueness test, and a validation.</p>
<p><strong>LearningEFDb.cs</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">public</span> <span class="dt">bool</span> <span class="fu">IsUniquePersonUmbrella</span>(PersonUmbrella personUmbrella)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="dt">var</span> entity = <span class="kw">this</span>.<span class="fu">PersonUmbrellas</span>.<span class="fu">SingleOrDefault</span>(a =&gt;</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">a.<span class="fu">PersonUmbrellaId</span> != personUmbrella.<span class="fu">PersonUmbrellaId</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">&amp; a.<span class="fu">PersonId</span> == personUmbrella.<span class="fu">PersonId</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">&amp; a.<span class="fu">UmbrellaId</span> == personUmbrella.<span class="fu">UmbrellaId</span>);</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">return</span> (entity == <span class="kw">null</span>);</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw">protected</span> <span class="kw">override</span> System.<span class="fu">Data</span>.<span class="fu">Entity</span>.<span class="fu">Validation</span>.<span class="fu">DbEntityValidationResult</span> <span class="fu">ValidateEntity</span>(</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">System.<span class="fu">Data</span>.<span class="fu">Entity</span>.<span class="fu">Infrastructure</span>.<span class="fu">DbEntityEntry</span> entityEntry,</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">IDictionary&lt;<span class="dt">object</span>, <span class="dt">object</span>&gt; items)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">{</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="kw">if</span> (items == <span class="kw">null</span>) { items = <span class="kw">new</span> Dictionary&lt;<span class="dt">object</span>, <span class="dt">object</span>&gt;(); }</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">//Magnifier Serial Number</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="kw">if</span> (entityEntry.<span class="fu">Entity</span> <span class="kw">is</span> Magnifier)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">{</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">var entity = (Magnifier)entityEntry.<span class="fu">Entity</span>;</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="kw">if</span> (!<span class="fu">IsUniqueMagnifierSerialNbr</span>(entity))</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">{</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">items.<span class="fu">Add</span>(<span class="kw">new</span> KeyValuePair&lt;<span class="dt">object</span>, <span class="dt">object</span>&gt;(Guid.<span class="fu">NewGuid</span>(),</a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="kw">new</span> <span class="fu">ValidationResult</span>(</a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="st">"Magnifier with this serial nbr already exists."</span>,</a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="kw">new</span> List&lt;<span class="dt">string</span>&gt;() { <span class="st">"SerialNbr"</span> }</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">)</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">)</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">);</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="kw">if</span> (entityEntry.<span class="fu">Entity</span> <span class="kw">is</span> PersonUmbrella)</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">{</a>
<a class="sourceLine" id="cb2-33" data-line-number="33">var entity = (PersonUmbrella)entityEntry.<span class="fu">Entity</span>;</a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="kw">if</span> (!<span class="fu">IsUniquePersonUmbrella</span>(entity))</a>
<a class="sourceLine" id="cb2-35" data-line-number="35">{</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">items.<span class="fu">Add</span>(<span class="kw">new</span> KeyValuePair&lt;<span class="dt">object</span>, <span class="dt">object</span>&gt;(Guid.<span class="fu">NewGuid</span>(),</a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="kw">new</span> <span class="fu">ValidationResult</span>(</a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="st">"Person-Umbrella combination already exists."</span>,</a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="kw">new</span> List&lt;<span class="dt">string</span>&gt;() { <span class="st">"PersonId"</span>, <span class="st">"UmbrellaId"</span> }</a>
<a class="sourceLine" id="cb2-40" data-line-number="40">)</a>
<a class="sourceLine" id="cb2-41" data-line-number="41">)</a>
<a class="sourceLine" id="cb2-42" data-line-number="42">);</a>
<a class="sourceLine" id="cb2-43" data-line-number="43">}</a>
<a class="sourceLine" id="cb2-44" data-line-number="44">}</a>
<a class="sourceLine" id="cb2-45" data-line-number="45"><span class="kw">return</span> <span class="kw">base</span>.<span class="fu">ValidateEntity</span>(entityEntry, items);</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">}</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode csharp"><code class="sourceCode cs"></code></pre></div>
<p>We also need to make PersonUmbrella validatable. ** ** <strong>LearningEFSchema.cs</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">public</span> <span class="kw">class</span> PersonUmbrella: IValidatableObject</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">//Primary Key</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">public</span> <span class="dt">int</span> PersonUmbrellaId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">//Unique Key (aka candidate key, could have been primary key)</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">//must be handled in DbContext.ValidateEntity.</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">//Foreign Keys</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">public</span> <span class="dt">int</span> PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw">public</span> <span class="dt">int</span> UmbrellaId { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">[Required]</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="kw">public</span> UmbrellaColors Color { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">//Navigation</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw">public</span> <span class="kw">virtual</span> Person Person { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="kw">public</span> <span class="kw">virtual</span> Umbrella Umbrella { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;PersonUmbrellaCover&gt; PersonUmbrellaCovers { <span class="kw">get</span>; <span class="kw">set</span>; }</a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="kw">public</span> <span class="fu">PersonUmbrella</span>()</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">{</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">PersonUmbrellaCovers = <span class="kw">new</span> HashSet&lt;PersonUmbrellaCover&gt;();</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb4-23" data-line-number="23"></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">IEnumerable&lt;ValidationResult&gt; IValidatableObject.<span class="fu">Validate</span>(ValidationContext validationContext)</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">{</a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">//Check for any Items in context. If they're ValidationResults, yield them.</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="kw">if</span> (validationContext.<span class="fu">Items</span> != <span class="kw">null</span>)</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">{</a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="kw">foreach</span> (var item <span class="kw">in</span> validationContext.<span class="fu">Items</span>)</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">{</a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="kw">if</span> (item.<span class="fu">Value</span> <span class="kw">is</span> ValidationResult)</a>
<a class="sourceLine" id="cb4-32" data-line-number="32">{</a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="kw">yield</span> <span class="kw">return</span> (ValidationResult)item.<span class="fu">Value</span>;</a>
<a class="sourceLine" id="cb4-34" data-line-number="34">}</a>
<a class="sourceLine" id="cb4-35" data-line-number="35">}</a>
<a class="sourceLine" id="cb4-36" data-line-number="36">}</a>
<a class="sourceLine" id="cb4-37" data-line-number="37">}</a>
<a class="sourceLine" id="cb4-38" data-line-number="38">}</a></code></pre></div>
<p>Hmm. If I were writing this, I would create an extension method for ValidationContext that returns the enumeration. That way I could reduce the amount of code. But, we'll leave that for after dinner. Now, Edward, update the program while I fix us each a Kiwi-ade. [Edward did so, clarifying why two errors would be thrown. His mother returned.] Ah! Good, dear, you put the new code near the other Umbrella code, instead of at the end. That shows you're thinking about context.</p>
<p><strong>Program.cs</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb5-1" data-line-number="1">Console.<span class="fu">WriteLine</span>(<span class="st">"Prove that there can't be two identical PersonUmbrella combinations"</span>);</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">jane.<span class="fu">PersonUmbrellas</span>.<span class="fu">Add</span>(<span class="kw">new</span> <span class="fu">PersonUmbrella</span>() { Umbrella = umbrella, Color = UmbrellaColors.<span class="fu">Blue</span> });</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">Console.<span class="fu">WriteLine</span>(<span class="st">"Jane's umbrellas: "</span> + jane.<span class="fu">PersonUmbrellas</span>.<span class="fu">Count</span>());</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">Console.<span class="fu">WriteLine</span>(<span class="st">"Two error lines show, because we store the error for two property names"</span>);</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="fu">SaveChanges</span>();</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">Console.<span class="fu">WriteLine</span>(<span class="st">"Remove the bad combination and continue."</span>);</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">_db.<span class="fu">PersonUmbrellas</span>.<span class="fu">Remove</span>(jane.<span class="fu">PersonUmbrellas</span>.<span class="fu">Skip</span>(<span class="dv">1</span>).<span class="fu">Take</span>(<span class="dv">1</span>).<span class="fu">Single</span>());</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="fu">SaveChanges</span>();</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">Console.<span class="fu">WriteLine</span>(<span class="st">"Add covers to Jane's Umbrellas"</span>);</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">jane.<span class="fu">PersonUmbrellas</span>.<span class="fu">First</span>().<span class="fu">PersonUmbrellaCovers</span>.<span class="fu">Add</span>(<span class="kw">new</span> <span class="fu">PersonUmbrellaCover</span>() { Description = <span class="st">"Plaid"</span> });</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">jane.<span class="fu">PersonUmbrellas</span>.<span class="fu">First</span>().<span class="fu">PersonUmbrellaCovers</span>.<span class="fu">Add</span>(<span class="kw">new</span> <span class="fu">PersonUmbrellaCover</span>() { Description = <span class="st">"Solid"</span> });</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">Console.<span class="fu">WriteLine</span>(<span class="st">"Save them, reget Jane from the database, and display."</span>);</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="fu">SaveChanges</span>();</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">jane = _db.<span class="fu">Persons</span>.<span class="fu">Single</span>(a =&gt; a.<span class="fu">Name</span> == <span class="st">"Jane Eager"</span>);</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="kw">foreach</span> (var cover <span class="kw">in</span> jane.<span class="fu">PersonUmbrellas</span>.<span class="fu">First</span>().<span class="fu">PersonUmbrellaCovers</span>)</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">{</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">Console.<span class="fu">WriteLine</span>(<span class="st">"Jane's umbrella has a cover that is "</span> + cover.<span class="fu">Description</span> + <span class="st">"."</span>);</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">}</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22">...</a>
<a class="sourceLine" id="cb5-23" data-line-number="23"></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="kw">static</span> <span class="dt">void</span> <span class="fu">WriteValidationErrors</span>(<span class="dt">string</span> exceptionError)</a>
<a class="sourceLine" id="cb5-25" data-line-number="25">{</a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="kw">if</span> (!String.<span class="fu">IsNullOrWhiteSpace</span>(exceptionError))</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">{</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">Console.<span class="fu">WriteLine</span>(<span class="st">"  ERROR: "</span> + exceptionError);</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="dt">var</span> errors = _db.<span class="fu">GetValidationErrors</span>();</a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="kw">foreach</span> (var entry <span class="kw">in</span> errors)</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">{</a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="kw">foreach</span> (var error <span class="kw">in</span> entry.<span class="fu">ValidationErrors</span>)</a>
<a class="sourceLine" id="cb5-34" data-line-number="34">{</a>
<a class="sourceLine" id="cb5-35" data-line-number="35">Console.<span class="fu">WriteLine</span>(<span class="st">"  ERROR: "</span> + error.<span class="fu">PropertyName</span> + <span class="st">" - "</span> + error.<span class="fu">ErrorMessage</span>);</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">}</a>
<a class="sourceLine" id="cb5-37" data-line-number="37">}</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">}</a></code></pre></div>
<p>[With his tongue between his teeth, Edward ran the program.]</p>
<pre class="console"><code>Create Person without a name.
Saving changes.
ERROR: Name - The Name field is required.
ERROR: ReadingRoom - The ReadingRoom field is required.
Add the required name and Library Card.
Add the Reading Room and save.
Saving changes.
Successful save.
Get the record we just saved, and display.
Person: Edward Farley has card: 123 and Reading Room: Lewis Wing Floor -3
Create and save Magnifier with required serial number
Saving changes.
Successful save.
Retrieve Magnifier, show it doesn't belong to someone.
Magnifier: Bar123, Person: available
Edward gets the Magnifier. Save and retrieve.
Saving changes.
Successful save.
Magnifier: Bar123, Person: Edward Farley
Try to add duplicate magnifier
Saving changes.
ERROR: SerialNbr - Magnifier with this serial nbr already exists.
Add/save Pencil setting Nickname to null.
Saving changes.
ERROR: Nickname - The Nickname field is required.
Set Nickname to empty string and save
Saving changes.
Successful save.
Retrieve pencil, change Nickname, save
Pencil: , Person: Edward Farley
Saving changes.
Successful save.
Pencil: Blackwing, Person: Edward Farley
Attempt adding Bicycle without a Person
Saving changes.
ERROR: The INSERT statement conflicted with the FOREIGN KEY constraint "FK_dbo.Bicycles_dbo.Persons_PersonId". The conflict occurred in database "EFDb", table "dbo.Persons", column 'PersonId'.
The statement has been terminated.
Set the Person, save, retrieve and show
Saving changes.
Successful save.
Model: Herman, Person: Edward Farley
Add two books and save
Saving changes.
Successful save.
Add another person and save
Saving changes.
Successful save.
Each person has read both books
Saving changes.
Successful save.
Edward Farley's books: The House of Arden, Harding's Luck
Jane Eager's books: The House of Arden, Harding's Luck
Create an umbrella for Edward
Jane uses it, too.
Saving changes.
Successful save.
PersonUmbrellas: 2
Edward's Umbrella: Red
Jane's Umbrella: Green
Prove that there can't be two identical PersonUmbrella combinations
Jane's umbrellas: 2
Two error lines show, because we store the error for two property names
Saving changes.
ERROR: PersonId - Person-Umbrella combination already exists.
ERROR: UmbrellaId - Person-Umbrella combination already exists.
Remove the bad combination and continue.
Saving changes.
Successful save.
Add covers to Jane's Umbrellas
Save them, reget Jane from the database, and display.
Saving changes.
Successful save.
Jane's umbrella has a cover that is Plaid.
Jane's umbrella has a cover that is Solid.
Build a chair and a sofa
Edward puts them in his reading room.
Saving changes.
Successful save.
Edward Farley has a chair made by Vincent's Chairs. It is not a recliner.
Edward Farley has a sofa made by Gaugin's Chairs. It has 3 cushions.
Finished
</code></pre>
<p>And the program says we're finished! I think so, too. Time for Kiwi-ade.</p>
<hr>
<p><a href="http://www.cookingwithcorey.info/2010/12/recipe-216-kickass-kiwi-ade.html">Kiwi-ade</a> (When I wrote this, I had no idea there were real kiwi-ade recipes.)</p>
<hr>
</div>
              </div>
              
  </section>
  <!-- posts only appear in home index -->
  <section id="posts">
    
    
  </section>
  <footer><p>Copyright (c) 2018 Charles L Flatt</p>
</footer>
  
</body>

</html>