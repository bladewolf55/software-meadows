<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <link rel='stylesheet' href='http://www.softwaremeadows.com/css/default.css' />
<link rel='stylesheet' href='http://www.softwaremeadows.com/css/tango.css' />

  <title>Auto Updating A New Windows 7 Installation | Software Meadows</title>
</head>

<body>
  <nav>
    <div id="menu">
      <ol>
<li><a href="http://www.softwaremeadows.com/">Home</a></li>
<li><a href="http://www.softwaremeadows.com/about">About</a></li>
</ol>

    </div>
    <div id="recent">
      <h2>Recent</h2>
      <a href='http://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a><a href='http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a><a href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_2'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 2</a><a href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_1'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 1</a><a href='http://www.softwaremeadows.com/posts/new-blog-engine'>New Blog Engine</a>
    </div>
    <div id="history">
      <h2>History</h2>
      <ol class='tree'><li class='history-year'><label for='2018'>2018</label><input type='checkbox'  id='2018' /><ol><li class='history-month'><label for='2018-3'>March</label><input type='checkbox'  id='2018-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a></li></ol></li><li class='history-month'><label for='2018-1'>January</label><input type='checkbox'  id='2018-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_2'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_1'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/new-blog-engine'>New Blog Engine</a></li></ol></li></ol></li><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-8'>August</label><input type='checkbox'  id='2017-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a></li></ol></li><li class='history-month'><label for='2017-7'>July</label><input type='checkbox'  id='2017-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a></li></ol></li><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-window-key-s-search-from'>Windows 8.1: Window Key + S = Search from Desktop</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='history-post'><a class='history-post' href='http://www.softwaremeadows.com/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li></ol>
    </div>
  </nav>
  <header>
    <div id="site-image">
      <img src="http://www.softwaremeadows.com/images/header.png" alt="" />
    </div>
    <h1 id="site-name"></h1>
    <div id="site-subtitle">A pleasant walk through computing</div>
  </header>
  <section id="content">
    
              <div class='post'>
                <h2 class='post-title'><a href='http://www.softwaremeadows.com/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></h2>
                <p class='post-info'><span class='posted-on'>2016-01-31 06:11</span></p>
                <div class='post-content'><p>There are many reasons you may create a clean Windows installation:</p>
<ul>
<li>Gold image for deployment</li>
<li>Lab installation for testing</li>
<li>Reinstall/recovery</li>
</ul>
<p>Installing all the Windows updates is tedious, especially with reboots. I don’t know why Microsoft doesn’t include a big “Bring up to date” button that would let you configure for reboots. I figured someone had this sorted, and started searching.</p>
<p>I can’t take credit for the PowerShell script, but am glad to have found it. It does have one oddity: it attempts to disable <a href="https://docs.oracle.com/cd/E23562_01/doc.1035/e14501/install.htm">OpenSSHd</a>. I don’t know if that’s a weird security leftover, or a precaution by the author. The script still runs even if the OpenSSHd service isn’t found, which it shouldn’t be. It’s not part of Windows.</p>
<p>I made these changes:</p>
<ol>
<li>Commented out OpenSSH commands</li>
<li>After searching for updates, I selectively hide updates such as KB3035583, which is the Windows 10 advertisement (not needed in my case).</li>
</ol>
<p>Here’s the link to the original script by Joe Fitzgerald:</p>
<p><a href="https://gist.github.com/joefitzgerald/8203265" class="uri" title="https://gist.github.com/joefitzgerald/8203265">https://gist.github.com/joefitzgerald/8203265</a></p>
<p>And the script itself, with my changes. To execute the script, right-click and choose Run with PowerShell. Or</p>
<ol>
<li>open admin command prompt</li>
<li>cd to location of script file</li>
<li>&gt; powershell.exe -ExecutionPolicy ByPass -File win-update.ps1</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="fu">param</span>($global:RestartRequired=<span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">$global:MoreUpdates=<span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">$global:MaxCycles=<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">function Check-<span class="fu">ContinueRestartOrEnd</span>() {</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">$RegistryKey = <span class="st">"HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">$RegistryEntry = <span class="st">"InstallWindowsUpdates"</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">switch</span> ($global:RestartRequired) {</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="dv">0</span> {</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">$prop = (Get-ItemProperty $RegistryKey).$RegistryEntry</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">if</span> ($prop) {</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">Write-Host <span class="st">"Restart Registry Entry Exists - Removing It"</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">Remove-ItemProperty -Path $RegistryKey -Name $RegistryEntry -ErrorAction SilentlyContinue</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">Write-Host <span class="st">"No Restart Required"</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">Check-WindowsUpdates</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">if</span> (($global:MoreUpdates -eq <span class="dv">1</span>) -<span class="fu">and</span> ($script:Cycles -le $global:MaxCycles)) {</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">Stop-Service $script:ServiceName -Force</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">Set-Service -Name $script:ServiceName -StartupType Disabled -Status Stopped</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">Install-WindowsUpdates</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">} <span class="fu">elseif</span> ($script:Cycles -gt $global:MaxCycles) {</a>
<a class="sourceLine" id="cb1-24" data-line-number="24">Write-Host <span class="st">"Exceeded Cycle Count - Stopping"</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">Write-Host <span class="st">"Done Installing Windows Updates"</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27">Set-Service -Name $script:ServiceName -StartupType Automatic -Status Running</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">}</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="dv">1</span> {</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">$prop = (Get-ItemProperty $RegistryKey).$RegistryEntry</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="kw">if</span> (-not $prop) {</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">Write-Host <span class="st">"Restart Registry Entry Does Not Exist - Creating It"</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34">Set-ItemProperty -Path $RegistryKey -Name $RegistryEntry -Value <span class="st">"C:\Windows\System32\WindowsPowerShell</span><span class="sc">\v</span><span class="st">1.0\powershell.exe -File $($script:ScriptPath)"</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-36" data-line-number="36">Write-Host <span class="st">"Restart Registry Entry Exists Already"</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37">}</a>
<a class="sourceLine" id="cb1-38" data-line-number="38"></a>
<a class="sourceLine" id="cb1-39" data-line-number="39">Write-Host <span class="st">"Restart Required - Restarting..."</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40">Restart-Computer</a>
<a class="sourceLine" id="cb1-41" data-line-number="41">}</a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="kw">default</span> {</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">Write-Host <span class="st">"Unsure If A Restart Is Required"</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="kw">break</span></a>
<a class="sourceLine" id="cb1-45" data-line-number="45">}</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">}</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">}</a>
<a class="sourceLine" id="cb1-48" data-line-number="48"></a>
<a class="sourceLine" id="cb1-49" data-line-number="49">function Install-<span class="fu">WindowsUpdates</span>() {</a>
<a class="sourceLine" id="cb1-50" data-line-number="50">$script:Cycles++</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">Write-Host 'Evaluating Available Updates:'</a>
<a class="sourceLine" id="cb1-52" data-line-number="52">$UpdatesToDownload = New-Object -ComObject 'Microsoft.<span class="fu">Update</span>.<span class="fu">UpdateColl</span>'</a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="kw">foreach</span> ($Update <span class="kw">in</span> $SearchResult.<span class="fu">Updates</span>) {</a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="kw">if</span> (($Update -ne $null) -<span class="fu">and</span> (!$Update.<span class="fu">IsDownloaded</span>)) {</a>
<a class="sourceLine" id="cb1-55" data-line-number="55">[<span class="dt">bool</span>]$addThisUpdate = $false</a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="kw">if</span> ($Update.<span class="fu">InstallationBehavior</span>.<span class="fu">CanRequestUserInput</span>) {</a>
<a class="sourceLine" id="cb1-57" data-line-number="57">Write-Host <span class="st">"SKIPPING: $($Update.Title) because it requires user input"</span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-59" data-line-number="59"><span class="kw">if</span> (!($Update.<span class="fu">EulaAccepted</span>)) {</a>
<a class="sourceLine" id="cb1-60" data-line-number="60">Write-Host <span class="st">"&gt; Note: $($Update.Title) has a license agreement that must be accepted. Accepting the license."</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61">$Update.<span class="fu">AcceptEula</span>()</a>
<a class="sourceLine" id="cb1-62" data-line-number="62">[<span class="dt">bool</span>]$addThisUpdate = $true</a>
<a class="sourceLine" id="cb1-63" data-line-number="63">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-64" data-line-number="64">[<span class="dt">bool</span>]$addThisUpdate = $true</a>
<a class="sourceLine" id="cb1-65" data-line-number="65">}</a>
<a class="sourceLine" id="cb1-66" data-line-number="66">}</a>
<a class="sourceLine" id="cb1-67" data-line-number="67"></a>
<a class="sourceLine" id="cb1-68" data-line-number="68"><span class="kw">if</span> ([<span class="dt">bool</span>]$addThisUpdate) {</a>
<a class="sourceLine" id="cb1-69" data-line-number="69">Write-Host <span class="st">"Adding: $($Update.Title)"</span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70">$UpdatesToDownload.<span class="fu">Add</span>($Update) |Out-Null</a>
<a class="sourceLine" id="cb1-71" data-line-number="71">}</a>
<a class="sourceLine" id="cb1-72" data-line-number="72">}</a>
<a class="sourceLine" id="cb1-73" data-line-number="73">}</a>
<a class="sourceLine" id="cb1-74" data-line-number="74"></a>
<a class="sourceLine" id="cb1-75" data-line-number="75"><span class="kw">if</span> ($UpdatesToDownload.<span class="fu">Count</span> -eq <span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb1-76" data-line-number="76">Write-Host <span class="st">"No Updates To Download..."</span></a>
<a class="sourceLine" id="cb1-77" data-line-number="77">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-78" data-line-number="78">Write-Host 'Downloading Updates...'</a>
<a class="sourceLine" id="cb1-79" data-line-number="79">$Downloader = $UpdateSession.<span class="fu">CreateUpdateDownloader</span>()</a>
<a class="sourceLine" id="cb1-80" data-line-number="80">$Downloader.<span class="fu">Updates</span> = $UpdatesToDownload</a>
<a class="sourceLine" id="cb1-81" data-line-number="81">$Downloader.<span class="fu">Download</span>()</a>
<a class="sourceLine" id="cb1-82" data-line-number="82">}</a>
<a class="sourceLine" id="cb1-83" data-line-number="83"></a>
<a class="sourceLine" id="cb1-84" data-line-number="84">$UpdatesToInstall = New-Object -ComObject 'Microsoft.<span class="fu">Update</span>.<span class="fu">UpdateColl</span>'</a>
<a class="sourceLine" id="cb1-85" data-line-number="85">[<span class="dt">bool</span>]$rebootMayBeRequired = $false</a>
<a class="sourceLine" id="cb1-86" data-line-number="86">Write-Host 'The following updates are downloaded and ready to be installed:'</a>
<a class="sourceLine" id="cb1-87" data-line-number="87"><span class="kw">foreach</span> ($Update <span class="kw">in</span> $SearchResult.<span class="fu">Updates</span>) {</a>
<a class="sourceLine" id="cb1-88" data-line-number="88"><span class="kw">if</span> ($Update.<span class="fu">IsDownloaded</span>) {</a>
<a class="sourceLine" id="cb1-89" data-line-number="89">Write-Host <span class="st">"&gt; $($Update.Title)"</span></a>
<a class="sourceLine" id="cb1-90" data-line-number="90">$UpdatesToInstall.<span class="fu">Add</span>($Update) |Out-Null</a>
<a class="sourceLine" id="cb1-91" data-line-number="91"></a>
<a class="sourceLine" id="cb1-92" data-line-number="92"><span class="kw">if</span> ($Update.<span class="fu">InstallationBehavior</span>.<span class="fu">RebootBehavior</span> -gt <span class="dv">0</span>){</a>
<a class="sourceLine" id="cb1-93" data-line-number="93">[<span class="dt">bool</span>]$rebootMayBeRequired = $true</a>
<a class="sourceLine" id="cb1-94" data-line-number="94">}</a>
<a class="sourceLine" id="cb1-95" data-line-number="95">}</a>
<a class="sourceLine" id="cb1-96" data-line-number="96">}</a>
<a class="sourceLine" id="cb1-97" data-line-number="97"></a>
<a class="sourceLine" id="cb1-98" data-line-number="98"><span class="kw">if</span> ($UpdatesToInstall.<span class="fu">Count</span> -eq <span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb1-99" data-line-number="99">Write-Host 'No updates available to install. Press any key.'</a>
<a class="sourceLine" id="cb1-100" data-line-number="100">$global:MoreUpdates=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101">$global:RestartRequired=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-102" data-line-number="102">#wait <span class="kw">for</span> user input, so message <span class="kw">is</span> seen</a>
<a class="sourceLine" id="cb1-103" data-line-number="103">$wait = $host.<span class="fu">UI</span>.<span class="fu">RawUI</span>.<span class="fu">ReadKey</span>(<span class="st">"NoEcho,IncludeKeyDown"</span>)</a>
<a class="sourceLine" id="cb1-104" data-line-number="104"><span class="kw">break</span></a>
<a class="sourceLine" id="cb1-105" data-line-number="105">}</a>
<a class="sourceLine" id="cb1-106" data-line-number="106"></a>
<a class="sourceLine" id="cb1-107" data-line-number="107"><span class="kw">if</span> ($rebootMayBeRequired) {</a>
<a class="sourceLine" id="cb1-108" data-line-number="108">Write-Host 'These updates may require a reboot'</a>
<a class="sourceLine" id="cb1-109" data-line-number="109">$global:RestartRequired=<span class="dv">1</span></a>
<a class="sourceLine" id="cb1-110" data-line-number="110">}</a>
<a class="sourceLine" id="cb1-111" data-line-number="111"></a>
<a class="sourceLine" id="cb1-112" data-line-number="112">Write-Host 'Installing updates...'</a>
<a class="sourceLine" id="cb1-113" data-line-number="113"></a>
<a class="sourceLine" id="cb1-114" data-line-number="114">$Installer = $script:UpdateSession.<span class="fu">CreateUpdateInstaller</span>()</a>
<a class="sourceLine" id="cb1-115" data-line-number="115">$Installer.<span class="fu">Updates</span> = $UpdatesToInstall</a>
<a class="sourceLine" id="cb1-116" data-line-number="116">$InstallationResult = $Installer.<span class="fu">Install</span>()</a>
<a class="sourceLine" id="cb1-117" data-line-number="117"></a>
<a class="sourceLine" id="cb1-118" data-line-number="118">Write-Host <span class="st">"Installation Result: $($InstallationResult.ResultCode)"</span></a>
<a class="sourceLine" id="cb1-119" data-line-number="119">Write-Host <span class="st">"Reboot Required: $($InstallationResult.RebootRequired)"</span></a>
<a class="sourceLine" id="cb1-120" data-line-number="120">Write-Host 'Listing of updates installed and individual installation results:'</a>
<a class="sourceLine" id="cb1-121" data-line-number="121"><span class="kw">if</span> ($InstallationResult.<span class="fu">RebootRequired</span>) {</a>
<a class="sourceLine" id="cb1-122" data-line-number="122">$global:RestartRequired=<span class="dv">1</span></a>
<a class="sourceLine" id="cb1-123" data-line-number="123">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-124" data-line-number="124">$global:RestartRequired=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-125" data-line-number="125">}</a>
<a class="sourceLine" id="cb1-126" data-line-number="126"></a>
<a class="sourceLine" id="cb1-127" data-line-number="127"><span class="kw">for</span>($i=<span class="dv">0</span>; $i -lt $UpdatesToInstall.<span class="fu">Count</span>; $i++) {</a>
<a class="sourceLine" id="cb1-128" data-line-number="128">New-Object -TypeName PSObject -Property @{</a>
<a class="sourceLine" id="cb1-129" data-line-number="129">Title = $UpdatesToInstall.<span class="fu">Item</span>($i).<span class="fu">Title</span></a>
<a class="sourceLine" id="cb1-130" data-line-number="130">Result = $InstallationResult.<span class="fu">GetUpdateResult</span>($i).<span class="fu">ResultCode</span></a>
<a class="sourceLine" id="cb1-131" data-line-number="131">}</a>
<a class="sourceLine" id="cb1-132" data-line-number="132">}</a>
<a class="sourceLine" id="cb1-133" data-line-number="133"></a>
<a class="sourceLine" id="cb1-134" data-line-number="134">Check-ContinueRestartOrEnd</a>
<a class="sourceLine" id="cb1-135" data-line-number="135">}</a>
<a class="sourceLine" id="cb1-136" data-line-number="136"></a>
<a class="sourceLine" id="cb1-137" data-line-number="137">function Check-<span class="fu">WindowsUpdates</span>() {</a>
<a class="sourceLine" id="cb1-138" data-line-number="138">Write-Host <span class="st">"Checking For Windows Updates"</span></a>
<a class="sourceLine" id="cb1-139" data-line-number="139">$Username = $env:USERDOMAIN + <span class="st">"</span><span class="sc">\"</span><span class="st"> + $env:USERNAME</span></a>
<a class="sourceLine" id="cb1-140" data-line-number="140"></a>
<a class="sourceLine" id="cb1-141" data-line-number="141">New-EventLog -Source $ScriptName -LogName 'Windows Powershell' -ErrorAction SilentlyContinue</a>
<a class="sourceLine" id="cb1-142" data-line-number="142"></a>
<a class="sourceLine" id="cb1-143" data-line-number="143">$Message = <span class="st">"Script: "</span> + $ScriptPath + <span class="st">"`nScript User: "</span> + $Username + <span class="st">"`nStarted: "</span> + (Get-Date).<span class="fu">toString</span>()</a>
<a class="sourceLine" id="cb1-144" data-line-number="144"></a>
<a class="sourceLine" id="cb1-145" data-line-number="145">Write-EventLog -LogName 'Windows Powershell' -Source $ScriptName -EventID <span class="st">"104"</span> -EntryType <span class="st">"Information"</span> -Message $Message</a>
<a class="sourceLine" id="cb1-146" data-line-number="146">Write-Host $Message</a>
<a class="sourceLine" id="cb1-147" data-line-number="147"></a>
<a class="sourceLine" id="cb1-148" data-line-number="148">$script:UpdateSearcher = $script:UpdateSession.<span class="fu">CreateUpdateSearcher</span>()</a>
<a class="sourceLine" id="cb1-149" data-line-number="149">$script:SearchResult = $script:UpdateSearcher.<span class="fu">Search</span>(<span class="st">"IsInstalled=0 and Type='Software' and IsHidden=0"</span>)</a>
<a class="sourceLine" id="cb1-150" data-line-number="150"><span class="kw">if</span> ($SearchResult.<span class="fu">Updates</span>.<span class="fu">Count</span> -ne <span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb1-151" data-line-number="151">$script:SearchResult.<span class="fu">Updates</span> |Select-Object -Property Title, Description, SupportUrl, UninstallationNotes, RebootRequired, EulaAccepted |Format-List</a>
<a class="sourceLine" id="cb1-152" data-line-number="152">$global:MoreUpdates=<span class="dv">1</span></a>
<a class="sourceLine" id="cb1-153" data-line-number="153">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-154" data-line-number="154">Write-Host 'There are no applicable updates'</a>
<a class="sourceLine" id="cb1-155" data-line-number="155">$global:RestartRequired=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-156" data-line-number="156">$global:MoreUpdates=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-157" data-line-number="157">}</a>
<a class="sourceLine" id="cb1-158" data-line-number="158"></a>
<a class="sourceLine" id="cb1-159" data-line-number="159">#clf hide undesired updates</a>
<a class="sourceLine" id="cb1-160" data-line-number="160"><span class="kw">foreach</span> ($Update <span class="kw">in</span> $SearchResult.<span class="fu">Updates</span>) {</a>
<a class="sourceLine" id="cb1-161" data-line-number="161"><span class="kw">if</span> ($Update.<span class="fu">Title</span>.<span class="fu">Contains</span>(<span class="st">"KB3035583"</span>)) {</a>
<a class="sourceLine" id="cb1-162" data-line-number="162">Write-Host <span class="st">"Hiding $($Update.Title) because it's the Windows 10 Notification."</span></a>
<a class="sourceLine" id="cb1-163" data-line-number="163">$Update.<span class="fu">IsHidden</span> = $TRUE</a>
<a class="sourceLine" id="cb1-164" data-line-number="164">}</a>
<a class="sourceLine" id="cb1-165" data-line-number="165">}</a>
<a class="sourceLine" id="cb1-166" data-line-number="166">}</a>
<a class="sourceLine" id="cb1-167" data-line-number="167"></a>
<a class="sourceLine" id="cb1-168" data-line-number="168">$script:ScriptName = $MyInvocation.<span class="fu">MyCommand</span>.<span class="fu">ToString</span>()</a>
<a class="sourceLine" id="cb1-169" data-line-number="169">$script:ScriptPath = $MyInvocation.<span class="fu">MyCommand</span>.<span class="fu">Path</span></a>
<a class="sourceLine" id="cb1-170" data-line-number="170">$script:UpdateSession = New-Object -ComObject 'Microsoft.<span class="fu">Update</span>.<span class="fu">Session</span>'</a>
<a class="sourceLine" id="cb1-171" data-line-number="171">$script:UpdateSession.<span class="fu">ClientApplicationID</span> = 'Packer Windows Update Installer'</a>
<a class="sourceLine" id="cb1-172" data-line-number="172">$script:UpdateSearcher = $script:UpdateSession.<span class="fu">CreateUpdateSearcher</span>()</a>
<a class="sourceLine" id="cb1-173" data-line-number="173">$script:SearchResult = New-Object -ComObject 'Microsoft.<span class="fu">Update</span>.<span class="fu">UpdateColl</span>'</a>
<a class="sourceLine" id="cb1-174" data-line-number="174">$script:Cycles = <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-175" data-line-number="175"></a>
<a class="sourceLine" id="cb1-176" data-line-number="176"># $script:ServiceName = <span class="st">"OpenSSHd"</span></a>
<a class="sourceLine" id="cb1-177" data-line-number="177"></a>
<a class="sourceLine" id="cb1-178" data-line-number="178"># Stop-Service $script:ServiceName -Force</a>
<a class="sourceLine" id="cb1-179" data-line-number="179"># Set-Service -Name $script:ServiceName -StartupType Disabled -Status Stopped</a>
<a class="sourceLine" id="cb1-180" data-line-number="180"></a>
<a class="sourceLine" id="cb1-181" data-line-number="181">Check-WindowsUpdates</a>
<a class="sourceLine" id="cb1-182" data-line-number="182"><span class="kw">if</span> ($global:MoreUpdates -eq <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb1-183" data-line-number="183">Install-WindowsUpdates</a>
<a class="sourceLine" id="cb1-184" data-line-number="184">} <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb1-185" data-line-number="185">Check-ContinueRestartOrEnd</a>
<a class="sourceLine" id="cb1-186" data-line-number="186">}</a></code></pre></div>
<h2 id="references">References</h2>
<p>An alternative method, clever but not as flexible.</p>
<p><a href="http://serverfault.com/questions/320750/best-way-to-fully-update-a-new-installed-windows" class="uri" title="http://serverfault.com/questions/320750/best-way-to-fully-update-a-new-installed-windows">http://serverfault.com/questions/320750/best-way-to-fully-update-a-new-installed-windows</a></p>
<p>WSUS Update class</p>
<p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa386099(v=vs.85).aspx" class="uri" title="https://msdn.microsoft.com/en-us/library/windows/desktop/aa386099(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa386099(v=vs.85).aspx</a></p>
<blockquote>

</blockquote>
<p>Powershell ReadKey doesn’t work when using editor.</p>
<p><a href="https://social.technet.microsoft.com/Forums/windowsserver/en-US/0787bcba-f977-400d-8b62-57ec64a71a8a/why-do-i-get-an-exception-calling-readkey?forum=winserverpowershell" class="uri" title="https://social.technet.microsoft.com/Forums/windowsserver/en-US/0787bcba-f977-400d-8b62-57ec64a71a8a/why-do-i-get-an-exception-calling-readkey?forum=winserverpowershell">https://social.technet.microsoft.com/Forums/windowsserver/en-US/0787bcba-f977-400d-8b62-57ec64a71a8a/why-do-i-get-an-exception-calling-readkey?forum=winserverpowershell</a></p>
</div>
              </div>
              
  </section>
  <!-- posts only appear in home index -->
  <section id="posts">
    
    
  </section>
  <footer><p>Copyright (c) 2018 Charles L Flatt</p>
</footer>
  
</body>

</html>