<!DOCTYPE html>
<html>
  <head>
    <title>Catching Up on Coding - TDD Part 1</title>
    <link rel="stylesheet" type="text/css" href="http://bladewolf55.gitlab.io/smblog/css/default.css">
  </head>
  <body>
    <header>
      Software Meadows      
    </header>
    <nav>
      <ul>
        <li><a href="http://bladewolf55.gitlab.io/smblog/">Home</a></li>
        <li class="dropdown">
          <a href="http://bladewolf55.gitlab.io/smblog/about">About</a>
        </li>
      </ul>
    </nav>
   	<aside id="sidebar">
	   <div id="recent">
       <p><strong>History</strong></p>
       <ol class='tree'><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-8'>August</label><input type='checkbox'  id='2017-8' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a></li></ol></li><li class='history-month'><label for='2017-7'>July</label><input type='checkbox'  id='2017-7' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a></li></ol></li><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-window-key-s-search-from'>windows-81-window-key-s-search-from</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='post'><a class='post' href='http://bladewolf55.gitlab.io/smblog/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li></ol>
      </div>
	    <div id="tags"></div>
	  </aside>
    <section id="content"><div class='post-title'>
                <a href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-1'><h1>Catching Up on Coding - TDD Part 1</h1></a>
                <p class='post-info'>2016-08-18 16:56</p>
            </div><p><img src="images/hqdefault.jpg" width="216" height="185" />I’ve been a software developer for twenty years, but am behind in some skills. This series chronicles my self-improvement.</p>
<p>There are some pretty high-tech tools out there, but nothing that matches the inspiration provided in the 70s TV show “<a href="https://en.wikipedia.org/wiki/Search_(TV_series)">Search</a>” (originally “Probe”). I don’t have Burgess Meredith, a Probe Scanner or a <a href="https://www.youtube.com/watch?v=Axb1EiJdbCg">catchy theme song</a> to help me out, so, like Hugh O’Brian, I’ll have to rely on my wits and <a href="https://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development (TDD)</a>.</p>
<p>Previously, on CUOC: <a href="http://www.softwaremeadows.com/2016/07/catching-up-on-coding-syllabus.html">The Syllabus</a>.<br />
Next Episode: <a href="http://www.softwaremeadows.com/2016/08/catching-up-on-coding-tdd-part-2.html">TDD Part 2</a></p>
<p> </p>
<h1 id="teaser">Teaser</h1>
<p>I’m not truly new to TDD. I <em>wrote</em> a (not very good) unit testing framework for Visual Basic 6 back in 2000. I’ve used TDD in professional projects. But now it’s time to make it a habit. To do that, I need a crash coarse, then retrofit my EduAgent code (applying “Test Eventually Development”) before writing new code.</p>
<h1 id="act-1-the-elemental-education">Act 1 – The Elemental Education</h1>
<p>Let’s give primary credit where it’s due. I read James Bender’s blog <a href="http://www.telerik.com/blogs/30-days-tdd-day-one-what-is-tdd">30 Days of TDD</a>. Bender’s series is very good overall. He does—frustratingly--have sloppy grammar and punctuation errors in every post. But his information is otherwise clear and solid. In fact, his description of SOLID is one of the best I’ve read. Thanks, James!</p>
<p>But first things first: what problem was TDD trying to solve?</p>
<p>Programmers, being human, don’t like to test our work. Most of us find it as hard as writers self-editing or composers checking for wrong notes. We <em>like</em> QA departments because they find our (careless) mistakes for us. We <em>pretend</em> to hate QA, because we pretend we’re egotistical Greek gods incapable of flaw.</p>
<p>Unit testing frameworks allowed testing the public interface of our classes. But that wasn’t enough. Kent Beck encouraged an upside-down approach to writing code, where we write a failing test first, then make it pass. This naturally builds up a library of tests that can be run quickly, reducing the chance of new features breaking the application, and building developer confidence. It also turned out that creating easily testable methods led to generally more maintainable code. Thus, some people revised TDD to mean test-driven <em>design</em>.</p>
<p>What are the elements of TDD? What’s needed to build testable code?</p>
<h2 id="elements">Elements</h2>
<ul>
<li>Test framework such as <a href="http://nunit.org/index.php?p=home">NUnit</a> and <a href="https://xunit.github.io/docs/getting-started-desktop.html">xUnit.net</a></li>
<li><a href="https://xunit.github.io/docs/getting-started-desktop.html#run-tests-visualstudio">Test runner</a>, for executing tests and viewing results.</li>
<li>Dependency Inversion (depend on abstractions) and Dependency Injection (decouple dependencies). Both are covered pretty well in <a href="http://www.codeproject.com/Articles/615139/An-Absolute-Beginners-Tutorial-on-Dependency-Inver">this article</a>.</li>
<li><a href="http://www.telerik.com/blogs/30-days-of-tdd-day-11-what-s-the-deal-with-mocking">Mocking</a> (control results from external resources, such as databases)</li>
<li><a href="http://www.telerik.com/blogs/30-days-of-tdd-day-nine-refactoring-basics">Refactoring</a> (improving code maintainability without changing the public interface)</li>
</ul>
<h1 id="act-2-some-code-a-test">Act 2 – Some Code, a Test</h1>
<p>Here’s a simple example of TDD, creating code that needs to be tested, and problems with it. I’m using xUnit.Net because I’ve always liked it. I won’t go into how to set up your environment; you can learn that at <a href="https://xunit.github.io/docs/getting-started-desktop.html">Getting Started with xUnit.net</a>. However, I do have three tips for using the VS Test Runner (which you open via Test &gt; Windows &gt; Test Explorer).</p>
<ul>
<li>Tear off the Test Explorer into its own window, so that you can easily resize and see all the tests.<br />
<a href="images/image_thumb3.png"><img src="images/image_thumb3.png" title="image" alt="image" width="571" height="344" /></a></li>
<li>Group the test results by class<br />
<a href="images/image_thumb5.png"><img src="images/image_thumb5.png" title="image" alt="image" width="380" height="173" /></a></li>
<li><p>In your unit test project, add an app.config file with the following setting. This causes the result to display only the method name instead of the fully qualified name.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">&lt;?xml version=<span class="st">&quot;1.0&quot;</span> encoding=<span class="st">&quot;utf-8&quot;</span> ?&gt;
&lt;configuration&gt;
  &lt;appSettings&gt;
    &lt;add key=<span class="st">&quot;xunit.methodDisplay&quot;</span> value=<span class="st">&quot;method&quot;</span>/&gt;
  &lt;/appSettings&gt;
&lt;/configuration&gt;</code></pre></div></li>
</ul>
<p>Our contrived application helps teachers grade coursework. We’re writing a class dealing with the coursework, and we’re consuming a third-party service—GradeMark—that returns a grade. One challenge, however, is we don’t control the grade that GradeMark returns given a set of scores. It depends on however the school has configured it. So, today 90% or higher could be an “A,” but tomorrow 93% or higher could be an “A.”</p>
<p>Our CourseWork class will have two methods. One that returns a percentage, and the other that returns a grade message. The grade in the message will come from the GradeMark “service,” and we’ll eventually have to mock that service.</p>
<p>First, in CourseWork, create a GetPercent function that doesn’t work. We want a failing test.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> CourseWork
    {
        <span class="kw">public</span> <span class="dt">decimal</span> <span class="fu">GetPercent</span>(<span class="dt">decimal</span> actual, <span class="dt">decimal</span> maximum)
        {
            <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">NotImplementedException</span>();
        }
    }</code></pre></div>
<p>In the unit tests project, create the test. Notice the naming convention I’m using along with nested classes; this will help make the test results readable. There are <a href="https://dzone.com/articles/7-popular-unit-test-naming">lots of naming conventions</a> out there. Consistency and clarity are the big deals.</p>
<p>Our first test checks that we get back a percent in a particular format. We want “a hundred percent” to return as 100.00.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> BasicTdd
    {
        <span class="kw">public</span> <span class="kw">class</span> CourseWork_GetPercent_Should
        {
            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">Return100PercentAs100PointZero</span>()
            {
                <span class="dt">var</span> cw = <span class="kw">new</span> <span class="fu">CourseWork</span>();
                <span class="dt">decimal</span> percent = cw.<span class="fu">GetPercent</span>(<span class="dv">100</span>, <span class="dv">100</span>);
                Assert.<span class="fu">Equal</span>(100m, percent);
            }
        }
    }</code></pre></div>
<p>Run it and it fails.</p>
<p><a href="images/image_thumb_25255B3_25255D.png"><img src="images/image_thumb_25255B3_25255D.png" title="image" alt="image" width="337" height="452" /></a></p>
<p>Write enough code for the test to pass.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">        <span class="kw">public</span> <span class="dt">decimal</span> <span class="fu">GetPercent</span>(<span class="dt">decimal</span> actual, <span class="dt">decimal</span> maximum)
        {
            <span class="dt">decimal</span> result = (actual / maximum) * 100m;
            <span class="kw">return</span> result;
        }</code></pre></div>
<p>Run the test and it passes.</p>
<p><a href="images/image_thumb_25255B6_25255D.png"><img src="images/image_thumb_25255B6_25255D.png" title="image" alt="image" width="341" height="458" /></a></p>
<p>Our next test will check if the result is rounded. This does <em>not</em> depend on the first test; they could be run in reverse order.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> BasicTdd
    {
        <span class="kw">public</span> <span class="kw">class</span> CourseWork_GetPercent_Should
        {
            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">RoundPercentToTwoDecimalPlaces</span>()
            {
                <span class="dt">var</span> cw = <span class="kw">new</span> <span class="fu">CourseWork</span>();
                <span class="dt">var</span> percent = cw.<span class="fu">GetPercent</span>(<span class="dv">1</span>, <span class="dv">7</span>);
                <span class="dt">var</span> roundedPercent = Math.<span class="fu">Round</span>(percent, <span class="dv">2</span>);
                Assert.<span class="fu">Equal</span>(roundedPercent, percent);
            }
        }
    }</code></pre></div>
<p>Run it, and it fails.</p>
<p><a href="images/image_thumb_25255B9_25255D.png"><img src="images/image_thumb_25255B9_25255D.png" title="image" alt="image" width="340" height="455" /></a></p>
<p>Update the code to make it pass.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">        <span class="kw">public</span> <span class="dt">decimal</span> <span class="fu">GetPercent</span>(<span class="dt">decimal</span> actual, <span class="dt">decimal</span> maximum)
        {
            <span class="dt">decimal</span> result = Math.<span class="fu">Round</span>((actual / maximum) * 100m,<span class="dv">2</span>);
            <span class="kw">return</span> result;
        }</code></pre></div>
<p><a href="images/image_thumb_25255B11_25255D.png"><img src="images/image_thumb_25255B11_25255D.png" title="image" alt="image" width="346" height="455" /></a></p>
<p>That’s enough to demonstrate a basic test. Now, on to something that will require mocking.</p>
<h1 id="act-3-mocu-mental-grades">Act 3 – Mocu-mental Grades</h1>
<p>Let’s create a class that represents our fictional third-party service, GradeMark. Remember, it returns a grade when supplied a percent, but we can’t depend on what that grade will be. For our dummy service, we won’t even use the percent parameter.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> GradeMarkService
    {
        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">GetGrade</span>(<span class="dt">decimal</span> percent)
        {
            <span class="dt">var</span> rnd = <span class="kw">new</span> <span class="fu">Random</span>();
            <span class="dt">int</span> code = rnd.<span class="fu">Next</span>(<span class="dv">65</span>, <span class="dv">70</span>);
            <span class="kw">return</span> ((<span class="dt">char</span>)code).<span class="fu">ToString</span>();
        }
    }</code></pre></div>
<p>We’re just returning a random letter A-D (no failures in our courses!). Back in our CourseWork class, we’ll start a function that returns a grade, and write a test for it that will fail. Here’s the test.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">        <span class="kw">public</span> <span class="kw">class</span> CourseWork_GetGradeMessage_Should
        {
            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">ReturnTheCorrectlyFormattedMessage</span>()
            {
                <span class="dt">var</span> cw = <span class="kw">new</span> <span class="fu">CourseWork</span>();
                <span class="dt">string</span> msg = cw.<span class="fu">GetGradeMessage</span>(<span class="dv">4</span>, <span class="dv">15</span>); <span class="co">//these values don&#39;t matter</span>
                <span class="dt">string</span> expected = <span class="st">&quot;The grade is B&quot;</span>;
                Assert.<span class="fu">Equal</span>(expected, msg);
            }
        }</code></pre></div>
<p>What we’re testing is getting the expected message text. We’re <em>not</em> testing if GetPercent works, and we’re <em>not</em> testing if the GradeMark service works. When we run the test, it fails, so we write this code to try to make it pass. Some people would say that we shouldn’t bother with the GradeMark service yet, but let’s assume we’re at that point.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">GetGradeMessage</span>(<span class="dt">decimal</span> actual, <span class="dt">decimal</span> maximum)
        {
            <span class="dt">var</span> service = <span class="kw">new</span> <span class="fu">GradeMarkService</span>();
            <span class="kw">return</span> <span class="st">&quot;The grade is &quot;</span> + service.<span class="fu">GetGrade</span>(<span class="fu">GetPercent</span>(actual, maximum));
        }</code></pre></div>
<p>We got lucky; it failed. But, remember, we can’t guarantee what letter grade will be returned. It could have passed. Run the tests enough times and it <em>will</em> pass.</p>
<p><a href="images/image_thumb_25255B13_25255D.png"><img src="images/image_thumb_25255B13_25255D.png" title="image" alt="image" width="347" height="456" /></a></p>
<p>Our GetGradeMessage function has a dependency on the GradeMark service, and is tightly coupled to it. We need to loosely couple that dependency by injecting it. We could do that at the method level, like this:</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">GetGradeMessage</span>(<span class="dt">decimal</span> actual, <span class="dt">decimal</span> maximum, GradeMarkService gradeService)
        {
            <span class="kw">return</span> <span class="st">&quot;The grade is &quot;</span> + gradeService.<span class="fu">GetGrade</span>(<span class="fu">GetPercent</span>(actual, maximum));
        }</code></pre></div>
<p>But, typically, a service like this is consumed by the class. So, we’ll inject it in the class’s constructor.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> CourseWork
    {
        GradeMarkService _gradeService;

        <span class="kw">public</span> <span class="fu">CourseWork</span>(GradeMarkService gradeService)
        {
            _gradeService = gradeService;
        }

        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">GetGradeMessage</span>(<span class="dt">decimal</span> actual, <span class="dt">decimal</span> maximum)
        {
            <span class="kw">return</span> <span class="st">&quot;The grade is &quot;</span> + _gradeService.<span class="fu">GetGrade</span>(<span class="fu">GetPercent</span>(actual, maximum));
        }</code></pre></div>
<p>Great, but that doesn’t really help us, does it? We still need a GradeMarkService to pass in during our test, <em>and</em> control the letter grade it returns. Using some mocking frameworks, it’s possible to mock a legacy object. But in this case, we’re hoping for one of two things from our vendor to make our lives easier.</p>
<p><strong>An Interface</strong></p>
<p>Ideally, our vendor has programmed to an interface, using the Dependency Inversion Principle. We’ll simulate that in our fictional service class.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">interface</span> IGrader
    {
        <span class="dt">string</span> <span class="fu">GetGrade</span>(<span class="dt">decimal</span> percent);
    }

    <span class="kw">public</span> <span class="kw">class</span> GradeMarkService: IGrader
    {
        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">GetGrade</span>(<span class="dt">decimal</span> percent)
        {
            <span class="dt">var</span> rnd = <span class="kw">new</span> <span class="fu">Random</span>();
            <span class="dt">int</span> code = rnd.<span class="fu">Next</span>(<span class="dv">65</span>, <span class="dv">70</span>);
            <span class="kw">return</span> ((<span class="dt">char</span>)code).<span class="fu">ToString</span>();
        }
    }</code></pre></div>
<p>Next, we update our class to inject the <em>interface we’re testing</em>, instead of the concrete instance.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> CourseWork
    {   IGrader _gradeService;

        <span class="kw">public</span> <span class="fu">CourseWork</span>(IGrader gradeService)
        {
            _gradeService = gradeService;
        }</code></pre></div>
<p>Our class is now ready for testing. We don’t need the GradeMarkService. We just need our own mock class implementing the required interface. Back in our test project, we’ll create that.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> GradeMarkServiceMock: IGrader
    {
        <span class="kw">public</span> <span class="dt">string</span> <span class="fu">GetGrade</span>(<span class="dt">decimal</span> percent)
        {
            <span class="kw">return</span> <span class="st">&quot;B&quot;</span>;
        }
    }</code></pre></div>
<p>And, update our tests to accept the mock object.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">Return100PercentAs100PointZero</span>()
            {
                <span class="dt">var</span> cw = <span class="kw">new</span> <span class="fu">CourseWork</span>(<span class="kw">new</span> <span class="fu">GradeMarkServiceMock</span>());
                <span class="dt">decimal</span> percent = cw.<span class="fu">GetPercent</span>(<span class="dv">1</span>, <span class="dv">1</span>);
                Assert.<span class="fu">Equal</span>(100m, percent);
            }
            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">RoundPercentToTwoDecimalPlaces</span>()
            {
                <span class="dt">var</span> cw = <span class="kw">new</span> <span class="fu">CourseWork</span>(<span class="kw">new</span> <span class="fu">GradeMarkServiceMock</span>());
                <span class="dt">var</span> percent = cw.<span class="fu">GetPercent</span>(<span class="dv">1</span>, <span class="dv">7</span>);
                <span class="dt">var</span> roundedPercent = Math.<span class="fu">Round</span>(percent, <span class="dv">2</span>);
                Assert.<span class="fu">Equal</span>(roundedPercent, percent);
            }
        }

        <span class="kw">public</span> <span class="kw">class</span> CourseWork_GetGradeMessage_Should
        {
            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">ReturnTheCorrectlyFormattedMessage</span>()
            {
                <span class="dt">var</span> cw = <span class="kw">new</span> <span class="fu">CourseWork</span>(<span class="kw">new</span> <span class="fu">GradeMarkServiceMock</span>());
                <span class="dt">string</span> msg = cw.<span class="fu">GetGradeMessage</span>(<span class="dv">4</span>, <span class="dv">15</span>); <span class="co">//these values don&#39;t matter</span>
                <span class="dt">string</span> expected = <span class="st">&quot;The grade is B&quot;</span>;
                Assert.<span class="fu">Equal</span>(expected, msg);
            }
        }</code></pre></div>
<p>When we run our tests a few times, the GetGradeMessage test passes consistently.</p>
<p><strong>An overridable class</strong></p>
<p>Our vendor could also have made the GetGrade method overridable. In that case, we’d create a mock object, override GetGrade, and always return “B”. But with a significant object, there could be many problems doing that. It’s best if we can program against interfaces, because that way<em>  we don’t have to use the original classes at all</em>.</p>
<p>What’s a real-world example? What about a shipping service that our application uses to calculate shipping rates? Several problems could exist in consuming that service instead of mocking it:</p>
<ul>
<li>It could be very slow to use that service in our tests.</li>
<li>It could return inconsistent results that affect our tests.</li>
<li>We might get charged every time we use the service.</li>
</ul>
<p>Databases are another example. Testing against a database is difficult because you want the data to always start in a consistent state. Database tests are slow. They are better left for <em>integration tests.</em></p>
<h2 id="refactoring">Refactoring</h2>
<p>The last step in TDD is making the code better, and also making the <em>tests</em> better. For example, we get an instance of the CourseWork class repeatedly. We can declare that as a class field. xUnit creates a new instance of the class for each test, so it will will always be a new instance of CourseWork.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">    <span class="kw">public</span> <span class="kw">class</span> BasicTdd
    {
        <span class="kw">public</span> <span class="kw">class</span> CourseWork_GetPercent_Should
        {
            <span class="kw">public</span> CourseWork _cw = <span class="kw">new</span> <span class="fu">CourseWork</span>(<span class="kw">new</span> <span class="fu">GradeMarkServiceMock</span>());

            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">Return100PercentAs100PointZero</span>()
            {
                <span class="dt">decimal</span> percent = _cw.<span class="fu">GetPercent</span>(<span class="dv">1</span>, <span class="dv">1</span>);
                Assert.<span class="fu">Equal</span>(100m, percent);
            }
            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">RoundPercentToTwoDecimalPlaces</span>()
            {
                <span class="dt">var</span> percent = _cw.<span class="fu">GetPercent</span>(<span class="dv">1</span>, <span class="dv">7</span>);
                <span class="dt">var</span> roundedPercent = Math.<span class="fu">Round</span>(percent, <span class="dv">2</span>);
                Assert.<span class="fu">Equal</span>(roundedPercent, percent);
            }
        }

        <span class="kw">public</span> <span class="kw">class</span> CourseWork_GetGradeMessage_Should
        {
            <span class="kw">public</span> CourseWork _cw = <span class="kw">new</span> <span class="fu">CourseWork</span>(<span class="kw">new</span> <span class="fu">GradeMarkServiceMock</span>());

            [Fact]
            <span class="kw">public</span> <span class="dt">void</span> <span class="fu">ReturnTheCorrectlyFormattedMessage</span>()
            {
                <span class="dt">string</span> msg = _cw.<span class="fu">GetGradeMessage</span>(<span class="dv">4</span>, <span class="dv">15</span>); <span class="co">//these values don&#39;t matter</span>
                <span class="dt">string</span> expected = <span class="st">&quot;The grade is B&quot;</span>;
                Assert.<span class="fu">Equal</span>(expected, msg);
            }
        }
    }</code></pre></div>
<p>Of course, rerun the tests and make sure they pass!</p>
<h1 id="tag">Tag</h1>
<p>Test-driven development isn’t natural at first. But it’s got a rat-hits-food-lever pleasure I can’t deny. Kind of like having Probe Control’s Angel Tompkins whispering in my ear.</p>
<p><img src="images/05Angel.jpg" /></p>
<h1 id="references">References</h1>
<p><a href="http://www.telerik.com/blogs/30-days-tdd-day-one-what-is-tdd">30 Days of TDD</a></p>
<p><a href="https://xunit.github.io/docs/getting-started-desktop.html">Getting Started with xUnit.net</a></p>
<p><a href="http://stackoverflow.com/a/32402361/1628707">xUnit: display only method name</a></p>
<p><a href="https://xunit.github.io/docs/shared-context.html">xUnit: Shared Context Between Tests</a></p>
<p><a href="https://dzone.com/articles/7-popular-unit-test-naming">7 Popular Unit Test Naming Conventions</a></p>
<p><a href="http://osherove.com/blog/2005/4/3/naming-standards-for-unit-tests.html">Naming standards for unit tests</a></p>
<p><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0ahUKEwiUz9fXv8vOAhXF4iYKHfpFBewQFggeMAA&amp;url=http%3A%2F%2Fwww.codeproject.com%2FArticles%2F615139%2FAn-Absolute-Beginners-Tutorial-on-Dependency-Inver&amp;usg=AFQjCNFs-TENpoHA01eOYXRVZkYqEEIC9w&amp;sig2=Qp3Zq6b199xguue2bGLDEg">An Absolute Beginner's Tutorial on Dependency Inversion Principle</a></p>
</section>
    
    <footer><p>Copyright &copy; Charles L Flatt</p></footer>
  </body>
</html>
