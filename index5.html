<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117916694-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-117916694-1');
  </script> <script src='https://www.softwaremeadows.com/header-scripts/prism.js'></script>
 <link rel='stylesheet' href='https://www.softwaremeadows.com/css/default.css' />
<link rel='stylesheet' href='https://www.softwaremeadows.com/css/prism.css' />
<link rel='stylesheet' href='https://www.softwaremeadows.com/css/responsive.css' />


  <title>Home | Software Meadows</title>
</head>

<body>
    <div class="row">
      <div class="col-left">
        <nav id="nav" class="nav">
          <div id="menu">
            <ol>
<li><a href="https://www.softwaremeadows.com/">Home</a></li>
<li><a href="https://www.softwaremeadows.com/about">About</a></li>
</ol>

          </div>
          <div id="recent">
            <h2>Recent</h2>
            <a href='https://www.softwaremeadows.com/posts/3_chrome_extensions_for_performance__research__and_blogging'>3 Chrome Extensions for Performance, Research, and Blogging</a><a href='https://www.softwaremeadows.com/posts/chrome_browser_pinned_startup_tabs'>Chrome Browser Pinned Startup Tabs</a><a href='https://www.softwaremeadows.com/posts/solving_nancyfx_tokenizer_keychain_bin_invalid_read_type_request_115'>Solving NancyFx Tokenizer keyChain.bin Invalid Read Type Request '115'</a><a href='https://www.softwaremeadows.com/posts/my_ideal_markdown_editor_-_thoughts_and_reviews_part_1'>My Ideal Markdown Editor - Thoughts and Reviews Part 1</a><a href='https://www.softwaremeadows.com/posts/my_why_and_how_of_posh_git_contenxt_menu_transcripts_and_tf_exe'>My Why and How of posh-git: Context Menu, Transcripts, and TF.exe</a>
          </div>
          <div id="history">
            <h2>History</h2>
            <ol class='tree'><li class='history-year'><label for='2018'>2018</label><input type='checkbox'  id='2018' /><ol><li class='history-month'><label for='2018-6'>June</label><input type='checkbox'  id='2018-6' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/3_chrome_extensions_for_performance__research__and_blogging'>3 Chrome Extensions for Performance, Research, and Blogging</a></li></ol></li><li class='history-month'><label for='2018-5'>May</label><input type='checkbox'  id='2018-5' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/chrome_browser_pinned_startup_tabs'>Chrome Browser Pinned Startup Tabs</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/solving_nancyfx_tokenizer_keychain_bin_invalid_read_type_request_115'>Solving NancyFx Tokenizer keyChain.bin Invalid Read Type Request '115'</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/my_ideal_markdown_editor_-_thoughts_and_reviews_part_1'>My Ideal Markdown Editor - Thoughts and Reviews Part 1</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/my_why_and_how_of_posh_git_contenxt_menu_transcripts_and_tf_exe'>My Why and How of posh-git: Context Menu, Transcripts, and TF.exe</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/how_to_secure-erase_regular_and_ssd_hard_drives_without_superstition'>How to Secure-Erase Regular and SSD Hard Drives Without Superstition</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/sql_permissions_for_data_folders'>SQL Permissions for Data Folders</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/grammar_for_developers_-_3_simple_rules_3_common_mistakes'>Grammar for Developers - 3 Simple Rules, 3 Common Mistakes</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/notes_on_improving_developer_team_practices_1'>Notes on Improving Developer Team Practices</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/using_git_locally_with_remote_tfvc'>Using Git Locally With Remote TFVC</a></li></ol></li><li class='history-month'><label for='2018-4'>April</label><input type='checkbox'  id='2018-4' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/raw_code_-_picture_renaming_and_sorting'>Raw Code - Picture Renaming and Sorting</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/becoming_a_professional_blogger_part_1'>Becoming a Professional Blogger Part 1</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/entity_framework_6_child_deletion_and_foreign_keys_string_int_guid'>Entity Framework 6 Child Deletion and Foreign Keys - String Int GUID</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/the_50-10_time_box_revising_pomodoro_for_software_development'>The 50-10 Time Box - Revising Pomodoro for Software Development</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/linqpad_-_refresh_entity_after_submitchanges_to_avoid_cached_results'>LINQPad - Refresh Entity after SubmitChanges to Avoid Cached Results</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/create_blog_post_using_markdown_monster_command_addin'>Create Blog Post Using Markdown Monster's Command Addin</a></li></ol></li><li class='history-month'><label for='2018-3'>March</label><input type='checkbox'  id='2018-3' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/batch_image_resize_checking_min_max_in_both_dimensions'>Batch Image Resize Checking Min Max in Both Dimensions</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/announcing_deepshadow'>Announcing DeepShadow</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/announcing_deftconfig'>Announcing DeftConfig</a></li></ol></li><li class='history-month'><label for='2018-1'>January</label><input type='checkbox'  id='2018-1' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs_2015_publish_asp_net_using_robocopy'>TFS 2015: Publish ASP.NET Using Robocopy</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_2'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 2</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/combining_veracrypt_google_backup_sync_sql_server_part_1'>Combining VeraCrypt, Google Backup & Sync, and Sql Server Part 1</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/new-blog-engine'>New Blog Engine</a></li></ol></li></ol></li><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-8'>August</label><input type='checkbox'  id='2017-8' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a></li></ol></li><li class='history-month'><label for='2017-7'>July</label><input type='checkbox'  id='2017-7' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a></li></ol></li><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/windows-81-window-key-s-search-from'>Windows 8.1: Window Key + S = Search from Desktop</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='history-post'><a class='history-post' href='https://www.softwaremeadows.com/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li></ol>
          </div>
          <a href="javascript:void(0);" class="icon" onclick="toggleNav()">&#9776;</a>
        </nav>
      </div>
      <div class="col-right">
        <header>
          <div id="site-image">
            <img src="https://www.softwaremeadows.com/images/header.png" alt="" />
          </div>
          <h1 id="site-name"></h1>
          <div id="site-subtitle">A pleasant walk through computing</div>
        </header>
        <section id="content">
          <h1 id="home">Home</h1>

        </section>
        <!-- posts only appear in home index -->
        <section id="posts">
          
              <div class='post'>
                <h2 class='post-title'><a href='https://www.softwaremeadows.com/posts/create_blog_post_using_markdown_monster_command_addin'>Create Blog Post Using Markdown Monster's Command Addin</a></h2>
                <p class='post-info'><span class='posted-on'>2018-04-15 12:29</span></p>
                <div class='post-content'><p><img src="https://www.softwaremeadows.com/posts/create_blog_post_using_markdown_monster_command_addin/images/header.png" alt="" /></p>
<p>This is a quick entry, mostly for me. I've been using the very good Markdown editor, <a href="https://markdownmonster.west-wind.com/">Markdown Monster</a>, and wanted to automate creating blog posts. I have a manual process that I thought I could somewhat automate.</p>
<p>MM has an addin that lets me write C# scripting and control a lot of the editor.</p>
<p><img src="https://www.softwaremeadows.com/posts/create_blog_post_using_markdown_monster_command_addin/images/2018-04-15%2012_33_00.png" alt="" /></p>
<p>Through both the documentation plus trial-and-error, I was able to do the following:</p>
<ol>
<li>Prompt for a post title.</li>
<li>Create the post file in a known folder.</li>
<li>Add metadata (frontmatter).</li>
<li>Open in a tab for editing.</li>
<li>Open the post folder's &quot;images&quot; folder.</li>
<li>Commit and publish</li>
</ol>
<p>Here's the code for creating the post, some of which is seen in the above screenshot.</p>
<blockquote>
<p>There were some things I couldn't accomplish, noted in the code comments, probably due to my ignorance of how the MM API is supposed to work.</p>
</blockquote>
<pre><code class="language-csharp">#r Westwind.Utilities.dll
#r Microsoft.VisualBasic.dll
using Westwind.Utilities;
using System.IO;

string defaultPath = @&quot;c:\path\to\posts&quot;;

string title = Microsoft.VisualBasic.Interaction.InputBox(&quot;File Name&quot;, &quot;Enter file name&quot;, &quot;&quot;, 600, 300);

if (String.IsNullOrWhiteSpace(title))
{
    return null;
}

string datetime = DateTime.Now.ToString(&quot;yyyyMMdd-HHmm&quot;);
string folder = Path.Combine(defaultPath, datetime + &quot; &quot; + title);
string file = Path.Combine(folder, title + &quot;.md&quot;);
string images = Path.Combine(folder, &quot;images&quot;);
string publishedOn = DateTime.Now.ToString(&quot;yyyy-MM-dd HH:mm&quot;);
string slug = title.ToLower();
slug = slug.Replace(&quot; &quot;, &quot;_&quot;);
slug = slug.Replace(&quot;?&quot;, &quot;_&quot;);
slug = slug.Replace(&quot;&amp;&quot;, &quot;_&quot;);
slug = slug.Replace(&quot;.&quot;, &quot;_&quot;);
string meta = String.Format(@&quot;---
Title          : {0}
PublishedOn    : {1}
Slug           : {2}
Tags           : 
Status         : Draft
---
&quot;,title, publishedOn, slug);

Directory.CreateDirectory(images);
File.WriteAllText(file,meta);
//Model.ExecuteProcess(&quot;explorer.exe&quot;, images);
//System.Threading.Thread.Sleep(2000);
Model.Window.OpenTab(file);
//I can't figure out how to set the cursor position
//The code seems right, but the cursor doesn't move unless I run the command
//from the addin window. Even then, the Console.WriteLine is what
//forces it to work.
var editor = Model.ActiveEditor;
var doc = Model.ActiveDocument;
var len = doc.CurrentText.Split('\n').Length;
Console.WriteLine(len);
Console.WriteLine(editor.GetLineNumber());
editor.SetCursorPosition(0,len);
editor.SetEditorFocus();


//Couldn't get this working
//var editor = Model.ActiveEditor;
////HACK: For some reason this allows the document to be edited.
//Console.WriteLine(editor.GetLineNumber());
//editor.SetSelection(meta);
//editor.SaveDocument();
</code></pre>
<p>To open the images folder, I created this command-let:</p>
<pre><code class="language-csharp">#r Westwind.Utilities.dll

using Westwind.Utilities;
using System.IO;
using System.Windows;

string folder = Model.ActiveDocument.Filename;
folder = Directory.GetParent(folder).FullName;

string images = Path.Combine(folder, &quot;images&quot;);
if (Directory.Exists(images)) {
    Model.ExecuteProcess(&quot;explorer.exe&quot;, images);
}
else {
    MessageBox.Show(&quot;No folder &quot; + images);
}
</code></pre>
<p>And, to publish, I do this. I have a batch file in my blog folder that takes care of the actual commit/push to Git.</p>
<pre><code class="language-csharp">#r Westwind.Utilities.dll

using Westwind.Utilities;
using System.IO;
using System.Windows;
using System.Diagnostics;

string folder = Model.ActiveDocument.Filename;
folder = Directory.GetParent(Path.Combine(folder,@&quot;..\..\..\&quot;)).FullName;

string cmd = Path.Combine(folder, &quot;publish.cmd&quot;);
cmd = @&quot;&quot;&quot;&quot; + cmd + @&quot;&quot;&quot;&quot;;
Console.WriteLine(cmd);
//Model.ExecuteProcess(&quot;cmd.exe&quot;, &quot;/C &quot; + cmd);
var si = new ProcessStartInfo();
si.FileName = &quot;cmd.exe&quot;;
si.Arguments = &quot;/C &quot; +  cmd;
si.WorkingDirectory = folder;

Process.Start(si);
</code></pre>
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='https://www.softwaremeadows.com/posts/batch_image_resize_checking_min_max_in_both_dimensions'>Batch Image Resize Checking Min Max in Both Dimensions</a></h2>
                <p class='post-info'><span class='posted-on'>2018-03-27 15:17</span></p>
                <div class='post-content'><p><img src="https://www.softwaremeadows.com/posts/batch_image_resize_checking_min_max_in_both_dimensions/images/image-resize.png" alt="" /></p>
<p>Here's some code that you can feel free to use, if it helps you. I had a large folder of photos that I use for Windows wallpaper. The sizes were all over the place, and I really wanted to better match my monitor's resolution. I looked around and didn't find a utility that exactly met my needs, which were:</p>
<ol>
<li>Batch resize photos using <em>not to exceed</em> values for width and height.</li>
<li>Ignore files below specified minimum width or height.</li>
<li>Simple way to ignore files based on name.</li>
</ol>
<blockquote>
<p>Basically, I wanted to resize most of my pictures to not exceed the monitor's natural width or height, and ignore really small ones.</p>
</blockquote>
<p>For exampe, let's say I had these photos. (All dimensions are given in WIDTH x HEIGHT)</p>
<ol>
<li>One in landscape mode at 2500x1600</li>
<li>One in landscape mode at 1400x1300</li>
<li>One in landscape mode at 1000x500</li>
<li>One in portrait mode at 2400x400 (weird!)</li>
<li>One in portrait mode at 400x500</li>
</ol>
<p>In the code, I set the variables this way:</p>
<pre><code class="language-csharp">    // Set the min/max values of a LANDSCAPE photo.
    // The code automatically handles if the photo is in portrait mode.
    int maxWidth = 1800;
    int maxHeight = 1190;

    int minWidth = 900;
    int minHeight = 600;
</code></pre>
<p>In plain-Engish, I'm expecting this:</p>
<ol>
<li>The width is too big, so reduce to 1800x1152</li>
<li>The height is too big, so reduce to 1281x1190</li>
<li>Both are too small. Resize to best fit of 1800x900</li>
<li>Height is too big, reduce to 1190x198</li>
<li>Ignored, because both dimensions are below our min dimensions</li>
</ol>
<p>Here's the code. Happy resizing!</p>
<blockquote>
<p><strong>Warning</strong><br />
I'm not responsible if this doesn't work. Backup your photos, and I recommend using an empty target folder.</p>
</blockquote>
<p><strong>Dependency:</strong>  NuGet package <a href="https://www.nuget.org/packages/ImageLibrary/">ImageLibrary</a></p>
<pre><code class="language-csharp">void Main()
{
	bool OkToSave = true;
    
    //Comment this to run in &quot;test&quot; mode
	if (!OkToSave) { Console.WriteLine(&quot;Not OK to Save&quot;); return;}

    // Set the min/max values of a LANDSCAPE photo.
    // The code automatically handles if the photo is in portrait mode.
    int maxWidth = 1800;
    int maxHeight = 1190;

    int minWidth = 900;
    int minHeight = 600;

    // Set the source and target folders
    string sourceFolder = 	@&quot;C:\Users\charl\Google Drive\Documents\Clients\_SM\SktBlogImages&quot;;
	string targetFolder = @&quot;C:\Users\charl\Google Drive\Documents\Clients\_SM\Apps\HCMA Web Site Slider\SktBlogImages&quot;;
	Directory.CreateDirectory(targetFolder);
	
	string[] formats = { &quot;.bmp&quot;, &quot;.jpg&quot;, &quot;.jpeg&quot;, &quot;.png&quot;};

    //Exclude these files, if any. E.g. {&quot;Bad Hair Day&quot;, &quot;Music Date&quot;}
    //Note that if the filename includes the string, it will be exluded.
    string[] files = { };
    
	foreach (string file in Directory.EnumerateFiles(sourceFolder))
	{
		string fileName = Path.GetFileName(file);
		string ext = Path.GetExtension(file).ToLower();
		if (formats.Contains(ext) &amp; !files.Contains(fileName))
		{
			var image = new KalikoImage(file);
            //LANDSCAPE
			int width = maxWidth;
			int height = maxHeight;
            //PORTRAIT            
			if (image.IsPortrait)
			{
				width = maxHeight;
				height = maxWidth;
				minWidth = minHeight;
				minHeight = minWidth;
			}

			KalikoImage scaledImage;
			//ignore if
			if (image.Height &lt; minHeight &amp; image.Width &lt; minWidth){
				scaledImage = image;
			}
			else
			{
				//resize, preserve aspect ratio			
				scaledImage = image.Scale(new FitScaling(maxWidth, maxHeight));
			}
			//save with original resolution
			ImageFormat format;
			if (new string[] { &quot;.jpg&quot;, &quot;.jpeg&quot; }.Contains(ext)) { format = ImageFormat.Jpeg; }
			else if (ext == &quot;.gif&quot;) { format = ImageFormat.Gif; }
			else if (ext == &quot;.bmp&quot;) { format = ImageFormat.Bmp; }
			else { format = ImageFormat.Png; }

			Console.WriteLine(fileName + &quot;   &quot; + scaledImage.Width + &quot; x &quot; + scaledImage.Height);
			if (OkToSave) { scaledImage.SaveImage(Path.Combine(targetFolder, fileName), format, true);}
		}
	}
}
</code></pre>
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='https://www.softwaremeadows.com/posts/announcing_deepshadow'>Announcing DeepShadow</a></h2>
                <p class='post-info'><span class='posted-on'>2018-03-23 18:26</span></p>
                <div class='post-content'><h2 id="an-assembly-to-help-generate-unit-test-data-from-entity-framework"><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/logo-128x128.png" alt="" /> an assembly to help generate unit test data from Entity Framework</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#the-problem">The Problem</a></li>
<li><a href="#enter-deepshadow">Enter DeepShadow</a></li>
<li><a href="#masking-data">Masking Data</a></li>
<li><a href="#complete-example">Complete Example</a></li>
</ul>
<h2 id="nuget-and-source">NuGet and Source</h2>
<ul>
<li><a href="https://www.nuget.org/packages/DeepShadow">DeepShadow on NuGet</a></li>
<li><a href="https://github.com/bladewolf55/DeepShadow">DeepShadow on GitHub</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>DeepShadow helps solve a specific yet common use case: the developer needs unit test data from complex models, and wishes she could use actual data with some modifications.</p>
<p>What if she could do this?</p>
<pre><code class="language-csharp">db.Customers.Take(2).GenerateEntitiesFromList(toConsole: true);
</code></pre>
<p>or this?</p>
<pre><code class="language-csharp">File.WriteAllText(&quot;MockData.txt&quot;, db.Customers.Take(2).GenerateEntitiesFromList());
</code></pre>
<p>And get something like this?</p>
<pre><code class="language-csharp">List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();

DeepShadowDbContext.Customer a1 = new DeepShadowDbContext.Customer();
a1.CustomerId = 1;
a1.Name = @&quot;Nicolo Paganini&quot;;
a1.Codes = new List&lt;String&gt;();
a1.Codes.Add(&quot;A1&quot;);
a1.Codes.Add(&quot;A2&quot;);
a1.Codes.Add(&quot;A3&quot;);
a1.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a1);
DeepShadowDbContext.Customer a2 = new DeepShadowDbContext.Customer();
a2.CustomerId = 2;
a2.Name = @&quot;Hilary Hahn&quot;;
a2.Codes = new List&lt;String&gt;();
a2.Codes.Add(&quot;A1&quot;);
a2.Codes.Add(&quot;A2&quot;);
a2.Codes.Add(&quot;A3&quot;);
a2.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a2);

return list;
</code></pre>
<h2 id="the-problem">The Problem</h2>
<p>Here are relatively simple parent-child domain classes. They map to SQL tables, and the application is using Entity Framework.</p>
<pre><code class="language-csharp">    public class Customer
    {
        public int CustomerId { get; set; }
        public string Name { get; set; }
        public List&lt;string&gt; Codes {get;set;}
        //Nav
        public List&lt;Order&gt; Orders { get; set; } = new List&lt;Order&gt;();
    }

    public class Order
    {
        public int OrderId { get; set; }
        public int CustomerId { get; set; }
        public DateTime OrderedOn { get; set; }
        public decimal? Discount { get; set; }
        //Nav
        public Customer Customer { get; set; }
    }
</code></pre>
<p>You might need to test a Web API that itself calls a service. The model that comes back from the service includes related classes (i.e. Navigation Properties).</p>
<pre><code class="language-csharp">    public class CustomersController : ApiController
    {
        ICustomerService _customerService = null;

        public CustomersController(ICustomerService customerSerivce) 
        {
            _customerService = customerService
        }
        
        //GET api/customers
        public List&lt;CustomerViewModel&gt; Get()
        {
            //Returns all orders for each customer
            List&lt;Customer&gt; customers = _customerService.GetAllCustomers();
            
            List&lt;CustomerViewModel&gt; model = new List&lt;CustomerViewModel&gt;();
            
            foreach (var customer in customers)
            {
                CustomerViewModel custViewModel = new CustomerViewModel()
                {
                    //transform to the view model
                    AllCapsName = customer.Name.ToUpper();
                    CodeList = String.Join(&quot; &quot;, customer.Codes);
                    Orders = customer.Orders.Select(a =&gt; new OrderViewModel() 
                    {
                      //likewise transform orders to the view model  
                    });
                }
                model.Add(custViewModel);
            }
            return Content(model);
        }
    }
</code></pre>
<p>You're not testing the service, but you need to be sure that the Customer/Order properties map correctly to the View Model properties. You don't want to find out in production you set the CustomerViewModel.CodeList property to Customer.Name.</p>
<p>A simplistic unit test might look like this (NOT a working example!):</p>
<pre><code class="language-csharp">    
    [TestMethod]
    public void TestMethod1()
    {
        ICustomerService mockService = new MockCustomerService();
        mockService.TestCustomers = MockData.CustomersAndOrders;
        var controller = new CustomersController(mockService);
        var actual = controller.Get();
        Assert.AreEqual(mockService.TestCustomers.Count(), actual.Count());
    }
</code></pre>
<p>The mock service could be as simple as this, if you didn't want to use a mocking framework. Each test can set what customers/orders it wants to use.</p>
<pre><code class="language-csharp">    
    public class CustomerSerivce: ICustomerService
    {
        public List&lt;Customer&gt; TestCustomers {get; set;}
        
        public List&lt;Customer&gt; GetAllCustomers() 
        {
            return TestCustomers;
        }
    }
    
</code></pre>
<p>So, great, but what about the actual test data? In many cases, it's OK to hand-craft what you need, like this:</p>
<pre><code class="language-csharp">    Customer customer = new Customer()
    {
        CustomerId = 1,
        Name = &quot;blamo&quot;,
        Codes = new List&lt;string&gt; {&quot;a&quot;,&quot;b&quot;},
        Orders = new List&lt;Order&gt;()
        {
            new Order()
            {
                OrderId = 11,
                CustomerId = 1,
                OrderedOn = DateTime.Parse(&quot;1/1/2001&quot;),
                Discount = 10.00m,
                Customer = this
            }
        }
    }
</code></pre>
<p>But what if you have classes with twenty or thirty properties? And what if those properties have some domain-specific data or formats that need careful testing?</p>
<pre><code>Customer.ID = {820bd7ae-fed3-419f-b778-8a817b45a968}
Customer.Name = Lewellen-Taft-O'Brien Marketing, LLC.
Customer.DiscountMatrix = 15.00|13.25|10.973
etc.
</code></pre>
<p>It's both tedious and error-prone to fabricate values like that when excellent test data is <em>right there in the database</em>! And, you already have code in the service to return that data. You just want to generate code to recreate the data in memory.</p>
<h2 id="enter-deepshadow">Enter DeepShadow</h2>
<p>With DeepShadow, you can potentially generate your models as simply as this:</p>
<pre><code class="language-csharp">//This is an Entity Framework DbContext
MyDb db = new MyDb();

//REQUIRED FOR Mock Data Generation
db.Configuration.ProxyCreationEnabled = false;

//Generate a list of models
db.Customers.Take(5).GenerateEntitiesFromList(toConsole: true);

//Generate from a single entity
db.Customers.First().GenerateEntitiesFromObject(toConsole: true);
</code></pre>
<p>The output will look like this:</p>
<pre><code class="language-csharp">List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();

DeepShadowDbContext.Customer a1 = new DeepShadowDbContext.Customer();
a1.CustomerId = 1;
a1.Name = @&quot;Nicolo Paganini&quot;;
a1.Codes = new List&lt;String&gt;();
a1.Codes.Add(&quot;A1&quot;);
a1.Codes.Add(&quot;A2&quot;);
a1.Codes.Add(&quot;A3&quot;);
a1.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a1);
DeepShadowDbContext.Customer a2 = new DeepShadowDbContext.Customer();
a2.CustomerId = 2;
a2.Name = @&quot;Hilary Hahn&quot;;
a2.Codes = new List&lt;String&gt;();
a2.Codes.Add(&quot;A1&quot;);
a2.Codes.Add(&quot;A2&quot;);
a2.Codes.Add(&quot;A3&quot;);
a2.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a2);

return list;
</code></pre>
<p>You'd put the above in some kind of unit testing MockData class, which is used to set the mock service method's return value.</p>
<pre><code class="language-csharp">public static class MockData
{
    public static List&lt;Customer&gt; CustomersAndOrders
    {
        get {
            List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();
            //data
            return list;
        }
    }
}
</code></pre>
<h2 id="masking-data">Masking Data</h2>
<p>Often you'll want to retrieve data from your database, but obscure sensitive data. That's easy enough in most cases without any help from DeepShadow.</p>
<pre><code class="language-csharp">//This is an Entity Framework DbContext
MyDb db = new MyDb();

//REQUIRED FOR Mock Data Generation
db.Configuration.ProxyCreationEnabled = false;

var employees = db.Employees.Where(a =&gt; a.Inactive == true).ToList();

//mask data
foreach (var employee in employees )
{
    employee.SSN = &quot;111-22-3456&quot;;
    employee.DateOfBirth = DateTime.Parse(&quot;1/1/2001&quot;);
}

//Generate a list of models
employees.GenerateEntitiesFromList(toConsole: true);

</code></pre>
<h2 id="complete-example">Complete Example</h2>
<p>I use (and recommend) the registered version of <a href="http://www.linqpad.net/">LINQPad</a> for generating the data, though you could also create a console app to do it. The code's almost exactly the same. In this example, I've created a SQL database named DeepShadowSample, and a console application with an Entity Framework DbContext named DeepShadowDb.</p>
<blockquote>
<p><strong>Important</strong><br />
If you're using LINQPad, you must have a registered version in order to easily install the NuGet package.</p>
</blockquote>
<h4 id="table-schema-and-data">Table Schema and Data</h4>
<pre><code class="language-sql">create table Customers
(
	CustomerId int not null primary key,
	Name varchar(max)
)

create table Codes
(
	Id int identity primary key,
	Name varchar(max)
)

create table Orders
(
	OrderId int not null primary key,
	CustomerId int not null foreign key references Customers(CustomerId),
	OrderedOn datetime not null,
	Discount decimal null
)


insert Customers select 1, 'Nicolo Paganini'
insert Customers select 2, 'Jasha Heifetz'
insert Customers select 3, 'Erica Morini'
insert Customers select 4, 'Hilary Hahn'

insert Orders select 2, 1, '2001-01-01', 10
insert Orders select 3, 2, '2002-01-01', 0
insert Orders select 4, 2, '2002-02-02', 5
insert Orders select 5, 3, '2012-05-23', 0
insert Orders select 6, 3, '2012-05-23 12:00:00.000', NULL
insert Orders select 7, 3, '2012-05-24', 0
insert Orders select 9, 4, '2015-12-12', NULL
insert Orders select 10, 4, '2017-12-15', 3

insert Codes (Name) values ('A1,A2,A3')
insert Codes (Name) values ('B4,B7')
</code></pre>
<h4 id="deepshadowdbcontext-console-app">DeepShadowDbContext Console App</h4>
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Data.Entity;

namespace DeepShadowDbContext
{
    class Program
    {
        static void Main(string[] args)
        {            
            var service = new CustomerService(new DeepShadowDb());
            Console.WriteLine(service.GetAllCustomers().Count()); //should return 4
            Console.ReadLine();
        }
    }

    public class CustomerService
    {
        DeepShadowDb _db;

        public CustomerService(DeepShadowDb db)
        {
            _db = db;
        }

        public List&lt;Customer&gt; GetAllCustomers()
        {
            var customers = _db.Customers.ToList();
            var codes = _db.Codes.First();
            foreach (var customer in customers)
            {
                customer.Codes = codes.Name.Split(',').ToList();
            }
            return customers;
        }
    }

    public class Customer
    {
        public int CustomerId { get; set; }
        public string Name { get; set; }
        public List&lt;string&gt; Codes { get; set; }
        //Navigation
        public List&lt;Order&gt; Orders { get; set; } = new List&lt;Order&gt;();
    }

    public class Order
    {
        public int OrderId { get; set; }
        public int CustomerId { get; set; }
        public DateTime OrderedOn { get; set; }
        public decimal? Discount { get; set; }
        //Navigation
        public Customer Customer { get; set; }
    }

    public class Code
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    public class DeepShadowDb : DbContext
    {
        public DbSet&lt;Customer&gt; Customers { get; set; }
        public DbSet&lt;Order&gt; Order { get; set; }
        public DbSet&lt;Code&gt; Codes { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;Customer&gt;().Ignore(a =&gt; a.Codes);
        }
    }
}
</code></pre>
<h4 id="app.config">App.Config</h4>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;configuration&gt;
  &lt;configSections&gt;
  &lt;/configSections&gt;
  &lt;startup&gt;
    &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.6.1&quot; /&gt;
  &lt;/startup&gt;
  &lt;connectionStrings&gt;
    &lt;add name=&quot;DeepShadowDb&quot; 
         connectionString=&quot;Server=.\SQLEXPRESS2016;Database=DeepShadowSample;Trusted_Connection=True;&quot;
         providerName=&quot;System.Data.SqlClient&quot;/&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;
</code></pre>
<h4 id="open-linqpad-to-a-new-c-statements-query">1. Open LINQPad to a new C# Statements query</h4>
<h4 id="add-entity-framework-connection">2. Add Entity Framework connection</h4>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_19_33.png" alt="" /></p>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_22_32.png" alt="" /></p>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_23_55.png" alt="" /></p>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_27_14.png" alt="" /></p>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_30_01.png" alt="" /></p>
<h4 id="set-the-query-connection">3. Set the query connection</h4>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_31_44.png" alt="" /></p>
<h4 id="press-f4-to-open-the-query-settings-and-click-add-nuget">4. Press F4 to open the query settings, and click Add NuGet</h4>
<h4 id="search-online-for-deepshadow-and-add-to-query">5. Search online for DeepShadow, and add to query</h4>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_36_34.png" alt="" /></p>
<h4 id="in-the-query-properties-window-additional-namespace-imports-tab-click-pick-from-assemblies-and-add-the-deepshadow-namespace">6. In the Query Properties window, Additional Namespace Imports tab, click Pick from assemblies and add the <code>DeepShadow</code>  namespace.</h4>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_42_34.png" alt="" /></p>
<p><img src="https://www.softwaremeadows.com/posts/announcing_deepshadow/images/2018-03-23%2015_41_19.png" alt="" /></p>
<h4 id="in-the-query-window-add-this-code.notice-how-its-essentially-copypaste-from-customerservice.getallcustomers">7. In the query window, add this code. Notice how it's essentially copy/paste from <code>CustomerService.GetAllCustomers</code>.</h4>
<pre><code class="language-csharp">DeepShadowDb _db = this;

//REQUIRED FOR Mock Data Generation
_db.Configuration.ProxyCreationEnabled = false;
//_db.Database.Connection.ConnectionString.Dump();
//////////////////

//This is the code copied from the supposed CustomerService.GetAllCustomers method
//Note that the service does some data manipulation by setting Codes from another table.

var customers = _db.Customers.ToList();
var codes = _db.Codes.First();
foreach (var customer in Customers)
{
    customer.Codes = codes.Name.Split(',').ToList();
}
//This generates the code
customers.GenerateEntitiesFromList(toConsole: true);

</code></pre>
<h4 id="the-result">8. The result</h4>
<pre><code class="language-csharp">List&lt;DeepShadowDbContext.Customer&gt; list = new List&lt;DeepShadowDbContext.Customer&gt;();

DeepShadowDbContext.Customer a1 = new DeepShadowDbContext.Customer();
a1.CustomerId = 1;
a1.Name = @&quot;Nicolo Paganini&quot;;
a1.Codes = new List&lt;String&gt;();
a1.Codes.Add(&quot;A1&quot;);
a1.Codes.Add(&quot;A2&quot;);
a1.Codes.Add(&quot;A3&quot;);
a1.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a1);
DeepShadowDbContext.Customer a2 = new DeepShadowDbContext.Customer();
a2.CustomerId = 2;
a2.Name = @&quot;Jasha Heifetz&quot;;
a2.Codes = new List&lt;String&gt;();
a2.Codes.Add(&quot;A1&quot;);
a2.Codes.Add(&quot;A2&quot;);
a2.Codes.Add(&quot;A3&quot;);
a2.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a2);
DeepShadowDbContext.Customer a3 = new DeepShadowDbContext.Customer();
a3.CustomerId = 3;
a3.Name = @&quot;Erica Morini&quot;;
a3.Codes = new List&lt;String&gt;();
a3.Codes.Add(&quot;A1&quot;);
a3.Codes.Add(&quot;A2&quot;);
a3.Codes.Add(&quot;A3&quot;);
a3.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a3);
DeepShadowDbContext.Customer a4 = new DeepShadowDbContext.Customer();
a4.CustomerId = 4;
a4.Name = @&quot;Hilary Hahn&quot;;
a4.Codes = new List&lt;String&gt;();
a4.Codes.Add(&quot;A1&quot;);
a4.Codes.Add(&quot;A2&quot;);
a4.Codes.Add(&quot;A3&quot;);
a4.Orders = new List&lt;DeepShadowDbContext.Order&gt;();
list.Add(a4);

return list;
</code></pre>
</div>
              </div>
               <div class='paging'><a href='index4.html'>Newer</a>&nbsp;&nbsp;&nbsp;<a href='index6.html'>Older</a></div>
        </section>
        <footer><p>Copyright (c) 2018 Charles L Flatt</p>
</footer>
      </div>
    </div>
    
    <script>
    function toggleNav() {
      var x = document.getElementById("nav");
      if (x.className === "nav") {
          x.className += " responsive";
      } else {
          x.className = "nav";
      }
  }</script>
  </body>

</html>