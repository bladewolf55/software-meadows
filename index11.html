<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <link rel='stylesheet' href='http://bladewolf55.gitlab.io/smblog/css/default.css' />
<link rel='stylesheet' href='http://bladewolf55.gitlab.io/smblog/css/tango.css' />

  <title>index</title>
</head>

<body>
  <nav>
    <div id="menu">
      <ol>
<li><a href="http://bladewolf55.gitlab.io/smblog/">Home</a></li>
<li><a href="http://bladewolf55.gitlab.io/smblog/about">About</a></li>
</ol>

    </div>
    <div id="recent">
      <h2>Recent</h2>
      <a href='http://bladewolf55.gitlab.io/smblog/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a><a href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a><a href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a><a href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a><a href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a>
    </div>
    <div id="history">
      <h2>History</h2>
      <ol class='tree'><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-window-key-s-search-from'>Windows 8.1: Window Key + S = Search from Desktop</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li><li class='history-year'><label for='1'>1</label><input type='checkbox'  id='1' /><ol><li class='history-month'><label for='1-1'>January</label><input type='checkbox'  id='1-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/angularjs-service-with-var-declarations'>angularjs-service-with-var-declarations</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/dont-use-data-prefix-in-angularjs'>dont-use-data-prefix-in-angularjs</a></li></ol></li></ol></li></ol>
    </div>
  </nav>
  <header>
    <div id="site-image">
      <img src="http://bladewolf55.gitlab.io/smblog/images/header.png" alt="" />
    </div>
    <h1 id="site-name"></h1>
    <div id="site-subtitle">A pleasant walk through computing</div>
  </header>
  <section id="content">
    <h1 id="home">Home</h1>

  </section>
  <!-- posts only appear in home index -->
  <section id="posts">
    
              <div class='post'>
                <h2 class='post-title'><a href='http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></h2>
                <p class='post-info'><span class='posted-on'>2016-06-15 12:53</span></p>
                <div class='post-content'><p>In a previous job, I needed to create Windows services. One thing that had tripped me up in the past was being able to debug the service. I figured someone (or ones) had solved this, so I did a bunch of research, consolidated what I found, documented it, and am finally (three years later?) posting it.</p>
<p>With the setup, below, you’ll have a Windows service that:</p>
<p>Runs in debug mode as you’d expect, without having to set unnecessary breakpoints.</p>
<p>Can run as a console app, allowing you to simply double-click the exe. This is useful for many things:</p>
<ul>
<li>Output running messages to the console (the same info you’re logging, most likely).</li>
<li>Perform one-off runs for things like integration services that run on a schedule.</li>
<li>Easily run elsewhere without having to install as a service.</li>
</ul>
<p>In addition, my steps include Nice-to-Dos like file and service naming, startup type, etc. These are more for me than you, so that I don’t have to look them up again, so think of them as a bonus.</p>
<p>The example below creates a sample FileImport service. Note that Visual Studio Express doesn’t have a Service project, but you can still create a service. (Sadly, I’m not covering that here, but might do so in a future post.)</p>
<p>Create a new Windows Service project.</p>
<p><a href="images/image_thumb_25255B2_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B2_25255D.png" title="image" alt="image" width="558" height="361" /></a></p>
<p>Change the Assembly output type to <strong>Console Application</strong> (for debugging).  This, in my opinion, is the big deal. I can now write my program just like I would a console application, which is how I want to think of a service.</p>
<p>This is also a good time to change the assembly information (title, company, etc.).</p>
<p><a href="images/image_thumb_25255B24_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B24_25255D.png" title="image" alt="image" width="659" height="440" /></a></p>
<p>Select Servic1.cs. Rename the Service1.cs file/class name, e.g. to FileImport.cs.</p>
<p><a href="images/image_thumb_25255B13_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B13_25255D.png" title="image" alt="image" width="195" height="133" /></a><a href="images/image_thumb_25255B14_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B14_25255D.png" title="image" alt="image" width="186" height="132" /></a></p>
<p><a href="images/image_thumb_25255B10_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B10_25255D.png" title="image" alt="image" width="395" height="149" /></a></p>
<p>Select FileImport.cs and view the designer (Shift F7), change ServiceName, e.g. FileImport</p>
<p><a href="images/image_thumb_25255B12_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B12_25255D.png" title="image" alt="image" width="241" height="208" /></a></p>
<p>Rick-click design surface and choose Add Installer</p>
<p><a href="images/image_thumb_25255B25_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B25_25255D.png" title="image" alt="image" width="166" height="118" /></a></p>
<p>Open ProjectInstaller.cs designer, select ServiceInstaller1 and edit:</p>
<p><a href="images/image_thumb_25255B26_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B26_25255D.png" title="image" alt="image" width="268" height="77" /></a></p>
<ul>
<li>Description</li>
<li>DisplayName, e.g. “Sample File Import”</li>
<li>ServiceName. Should be correct from Service1 designer change, otherwise FileImport</li>
<li>StartType, e.g. Automatic</li>
</ul>
<p><a href="images/image_thumb_25255B19_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B19_25255D.png" title="image" alt="image" width="277" height="253" /></a></p>
<p>If desired, in ProjectInstaller designer, select ServiceProcessInstaller and edit</p>
<ul>
<li>Account = User (set to NetworkService or LocalService if desired.)</li>
</ul>
<p><a href="images/image_thumb_25255B27_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B27_25255D.png" title="image" alt="image" width="276" height="95" /></a></p>
<p><a href="images/image_thumb_25255B28_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B28_25255D.png" title="image" alt="image" width="277" height="188" /></a></p>
<p>Open FileImport.cs code view, create a public member Start() for debugging.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">namespace</span> FileImport
{
<span class="kw">public</span> <span class="kw">partial</span> <span class="kw">class</span> FileImport : ServiceBase
{
<span class="kw">public</span> <span class="fu">FileImport</span>()
{
<span class="fu">InitializeComponent</span>();
}

<span class="kw">protected</span> <span class="kw">override</span> <span class="dt">void</span> <span class="fu">OnStart</span>(<span class="dt">string</span>[] args)
{
}

<span class="kw">protected</span> <span class="kw">override</span> <span class="dt">void</span> <span class="fu">OnStop</span>()
{
}

<span class="kw">public</span> <span class="dt">void</span> <span class="fu">Start</span>(<span class="dt">string</span>[] args)
{
<span class="fu">OnStart</span>(args);
}

}
}</code></pre></div>
<p>Change Program.Main() to this (or similar).</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">namespace</span> FileImport
{
<span class="kw">static</span> <span class="kw">class</span> Program
{
<span class="co">///</span>
<span class="co">/// The main entry point for the application.</span>
<span class="co">///</span>
<span class="kw">static</span> <span class="dt">void</span> <span class="fu">Main</span>()
{
ServiceBase[] ServicesToRun;
ServicesToRun = <span class="kw">new</span> ServiceBase[]
{
<span class="kw">new</span> <span class="fu">FileImport</span>()
};
<span class="co">// If you don’t want the exe to run as console when double-clicked, then use:</span>
<span class="co">//   if (System.Diagnostics.Debugger.IsAttached)</span>
<span class="kw">if</span> (Environment.<span class="fu">UserInteractive</span>)
{
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Service running, press  to stop.&quot;</span>);
((FileImport)ServicesToRun[<span class="dv">0</span>]).<span class="fu">Start</span>(<span class="kw">null</span>);
Console.<span class="fu">ReadLine</span>();
((FileImport)ServicesToRun[<span class="dv">0</span>]).<span class="fu">Stop</span>();
}
<span class="kw">else</span>
{
ServiceBase.<span class="fu">Run</span>(ServicesToRun);
}
}
}
}</code></pre></div>
<p>At this point, you can run the project. It will open a console window and wait.</p>
<p><a href="images/image_thumb_25255B30_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B30_25255D.png" title="image" alt="image" width="366" height="187" /></a></p>
<p>If you install the service, when the service is started it behaves like any other service, i.e. doesn’t display the console window.</p>
<p>Our service isn’t doing anything, so let’s see what the benefit is to creating a service as a console app instead of the default Windows app. We’re not going to do anything fancy like multithreading, I just want to give a flavor. In FileImport.cs, use the following code.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">using</span> System;
<span class="kw">using</span> System.<span class="fu">Collections</span>.<span class="fu">Generic</span>;
<span class="kw">using</span> System.<span class="fu">ComponentModel</span>;
<span class="kw">using</span> System.<span class="fu">Data</span>;
<span class="kw">using</span> System.<span class="fu">Diagnostics</span>;
<span class="kw">using</span> System.<span class="fu">Linq</span>;
<span class="kw">using</span> System.<span class="fu">ServiceProcess</span>;
<span class="kw">using</span> System.<span class="fu">Text</span>;
<span class="kw">using</span> System.<span class="fu">Threading</span>.<span class="fu">Tasks</span>;
<span class="kw">using</span> System.<span class="fu">Timers</span>;

<span class="kw">namespace</span> FileImport
{
<span class="kw">public</span> <span class="kw">partial</span> <span class="kw">class</span> FileImport : ServiceBase
{
Timer _timer = <span class="kw">new</span> <span class="fu">Timer</span>(<span class="dv">5000</span>);

<span class="kw">public</span> <span class="fu">FileImport</span>()
{
<span class="fu">InitializeComponent</span>();
}

<span class="kw">protected</span> <span class="kw">override</span> <span class="dt">void</span> <span class="fu">OnStart</span>(<span class="dt">string</span>[] args)
{
_timer.<span class="fu">Elapsed</span> += OnTimerElapsed;
_timer.<span class="fu">Start</span>();
}

<span class="kw">private</span> <span class="dt">void</span> <span class="fu">OnTimerElapsed</span>(<span class="dt">object</span> sender, ElapsedEventArgs e)
{
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;The time is--or, to be precise, was: &quot;</span> + DateTime.<span class="fu">Now</span>.<span class="fu">ToString</span>());
}

<span class="kw">protected</span> <span class="kw">override</span> <span class="dt">void</span> <span class="fu">OnStop</span>()
{
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Stopping. Here&#39;s one method where you&#39;d handle processes that shouldn&#39;t be interrupted, gracefully stop them, then end the service. Press  to finish stopping.&quot;</span>);
_timer.<span class="fu">Stop</span>();
_timer.<span class="fu">Dispose</span>();
<span class="co">//etc.</span>
Console.<span class="fu">ReadLine</span>();
}

<span class="kw">public</span> <span class="dt">void</span> <span class="fu">Start</span>(<span class="dt">string</span>[] args)
{
<span class="fu">OnStart</span>(args);
}

}
}</code></pre></div>
<p>Run the program and it will output something like this.</p>
<p><a href="images/image_thumb_25255B33_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B33_25255D.png" title="image" alt="image" width="479" height="213" /></a></p>
<p>Now, if you were to install and run this as a service, you still wouldn’t see anything. But you can imagine adding appending text to a file (for example) in the OnTimerElapsed event.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">private</span> <span class="dt">void</span> <span class="fu">OnTimerElapsed</span>(<span class="dt">object</span> sender, ElapsedEventArgs e)
{
<span class="dt">string</span> msg = <span class="st">&quot;The time is--or, to be precise, was: &quot;</span> + DateTime.<span class="fu">Now</span>.<span class="fu">ToString</span>() + <span class="st">&quot;</span><span class="sc">\r\n</span><span class="st">&quot;</span>;
System.<span class="fu">IO</span>.<span class="fu">File</span>.<span class="fu">AppendAllText</span>(Environment.<span class="fu">ExpandEnvironmentVariables</span>(<span class="st">&quot;%USERPROFILE%</span><span class="sc">\\</span><span class="st">TestFileImport.txt&quot;</span>),msg);
Console.<span class="fu">WriteLine</span>(msg);
}</code></pre></div>
<p>Of course, I can drop into the debugger as expected.</p>
<p><a href="images/image_thumb_25255B36_25255D.png"><img src="http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service/images/image_thumb_25255B36_25255D.png" title="image" alt="image" width="316" height="129" /></a></p>
<p>There you go! A simple way to build better Windows services.</p>
<h1 id="references">References</h1>
<p><strong><a href="http://einaregilsson.com/run-windows-service-as-a-console-program/" class="uri">http://einaregilsson.com/run-windows-service-as-a-console-program/</a></strong></p>
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='http://bladewolf55.gitlab.io/smblog/posts/underrated-work-skills'>(Underrated) Work Skills</a></h2>
                <p class='post-info'><span class='posted-on'>2016-06-03 13:03</span></p>
                <div class='post-content'><p>I’m not sure what “underrated” means. Or even whether these are truly “skills.” But, this article was interesting, so I synthesized and summarized what the (supposed) CEOs were looking for.</p>
<p><a href="http://www.knowable.com/a/10-ceos-answer-the-question-what-are-the-most-underrated-skills-most-employees-?utm_content=inf_10_3136_2&amp;tse_id=INF_c63402c0254411e6b4d0110a784531ce">10 CEOs Answer The Question, What Are The Most Underrated Skills Most Employees Lack?</a></p>
<p>The one “skill” I take exception to was related to email. The CEO argued that a person should be able to find an email--without searching—in under thirty seconds. While I think it’s good and valuable to keep a clean inbox, I think it’s dumb to shortchange searching like that. By searching, I can find an email I need in under five seconds. Isn’t that a better use of my time?</p>
<p>My area for improvement: Organize and lead a team.</p>
<ol>
<li>Be succinct</li>
<li>Be reliable (manage tasks/deliverables without reminders).</li>
<li>Use elegant humor</li>
<li>Write well</li>
<li>Reduce chatter (inbox zero)</li>
<li>Use lists effectively</li>
<li>Golden Skill Triangle:</li>
</ol>
<ul>
<li>Figure out what to do (next)</li>
<li>Write effective goals (with due dates).</li>
<li>Organize and lead a team to execute large scale plans.</li>
</ul>
<ol>
<li>Own the job</li>
</ol>
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='http://bladewolf55.gitlab.io/smblog/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></h2>
                <p class='post-info'><span class='posted-on'>2016-05-22 11:08</span></p>
                <div class='post-content'><p>If you’re looking for a thorough comparative review, this isn’t it! But, here are a few tools I looked at for converting a complex VB.NET project to C#.</p>
<p><a href="https://visualstudiogallery.msdn.microsoft.com/fab9aebd-a821-4480-b79f-73722535b3e4">Convert.NET</a> by <a href="http://fishcodelib.com/">fish’s dotNET</a></p>
<ul>
<li>Cannot be used commercially with buying the (reasonably priced) license.</li>
<li>Stand-alone, but can be added as Tool.</li>
<li>Other features besides converting.</li>
<li>Conversion of project had the most problems of any tool.</li>
</ul>
<p><a href="http://www.icsharpcode.net/opensource/sd/">SharpDevelop</a></p>
<ul>
<li>Only 4.4 can convert from VB to C#. Feature does not exist in version 5.</li>
<li>Project isn’t very active, because free versions of Visual Studio are much more readily available.</li>
<li>Conversion fidelity will work better with .NET 4.5 or older.</li>
<li>Better conversion that Convert.NET</li>
<li>Free for commercial use.</li>
</ul>
<p><a href="http://vbconversions.com/">VBConversions</a></p>
<ul>
<li>Commercial tool, expensive $199. (But worth it for a paid contract.)</li>
<li>Claims near-perfect fidelity. See the blog entry <a href="http://vbconversions.com/the-naked-truth-about-vb-net-to-c-converters/">The Naked Truth About VB.NET to C# Converters</a></li>
<li>Trial version has 2000 line project conversion limit.</li>
</ul>
<p><a href="http://www.tangiblesoftwaresolutions.com/Product_Details/Instant_CSharp.html">Instant C#</a></p>
<ul>
<li>Commercial tool, expensive $159. (But worth it for a paid contract.)</li>
<li>Claims near-perfect fidelity.</li>
<li>Has free edition for smaller projects, 2000 line project conversion limit.</li>
</ul>
<p>My choice: VBConversions, because of the better post conversion tools that show where errors are. However, one thing Instant C# did that I like is automatically generate a variable copy when a VB.NET for…each manipulated the iterating variable.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">foreach</span> (<span class="dt">string</span> field <span class="kw">in</span> fields)
{
<span class="dt">string</span> fieldCopy = field;
fieldCopy = fieldCopy.<span class="fu">Trim</span>();
...
}</code></pre></div>
<p>VBConversions marked it with an error, essentially leaving the code with a bug. If I weren’t to check the errors, this could be a problem because the code would still compile.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">foreach</span> (<span class="dt">string</span> field <span class="kw">in</span> fields)
{
<span class="co">// field = field.Trim(); VBConversions Warning: A foreach variable can&#39;t be assigned to in C#.</span>
<span class="dt">string</span> fieldType = <span class="st">&quot;&quot;</span>;
...
}</code></pre></div>
<p>In both cases, it would be wise to set up Visual Studio to treat their comments as Tasks, assuming they consistently start with “VBConversions” or  “INSTANT C#”. Then, go through each comment and remove it after evaluation.</p>
<p>Regardless of the tool, professional diligence says to review every error/message the conversion reports.</p>
<h1 id="references">References</h1>
<p><a href="http://bartwullems.blogspot.com/2013/05/get-rid-of-missing-xml-comment-for.html">Get rid of the ‘Missing XML comment for publicly visible type or member’ warning</a></p>
</div>
              </div>
              
    <div class='paging'><a href='index10.html'>Newer</a>&nbsp;&nbsp;&nbsp;<a href='index12.html'>Older</a></div>
  </section>
  <footer><p>Copyright (c) 2018 Charles L Flatt</p>
</footer>
  
</body>

</html>