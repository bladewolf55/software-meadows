<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <link rel='stylesheet' href='http://bladewolf55.gitlab.io/smblog/css/default.css' />
<link rel='stylesheet' href='http://bladewolf55.gitlab.io/smblog/css/tango.css' />

  <title>index</title>
</head>

<body>
  <nav>
    <div id="menu">
      <ol>
<li><a href="http://bladewolf55.gitlab.io/smblog/">Home</a></li>
<li><a href="http://bladewolf55.gitlab.io/smblog/about">About</a></li>
</ol>

    </div>
    <div id="recent">
      <h2>Recent</h2>
      <a href='http://bladewolf55.gitlab.io/smblog/posts/new-blog-engine'>New Blog Engine</a><a href='http://bladewolf55.gitlab.io/smblog/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a><a href='http://bladewolf55.gitlab.io/smblog/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a><a href='http://bladewolf55.gitlab.io/smblog/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a><a href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a>
    </div>
    <div id="history">
      <h2>History</h2>
      <ol class='tree'><li class='history-year'><label for='2018'>2018</label><input type='checkbox'  id='2018' /><ol><li class='history-month'><label for='2018-1'>January</label><input type='checkbox'  id='2018-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/new-blog-engine'>New Blog Engine</a></li></ol></li></ol></li><li class='history-year'><label for='2017'>2017</label><input type='checkbox'  id='2017' /><ol><li class='history-month'><label for='2017-8'>August</label><input type='checkbox'  id='2017-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/dont-use-data-prefix-in-angularjs'>Don't use "data" prefix in AngularJS</a></li></ol></li><li class='history-month'><label for='2017-7'>July</label><input type='checkbox'  id='2017-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/angularjs-service-with-var-declarations'>AngularJS service with var declarations instead of this. assignments</a></li></ol></li><li class='history-month'><label for='2017-6'>June</label><input type='checkbox'  id='2017-6' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/factory-resetting-android-without'>Factory Resetting Android Without Losing Your Life (Metaphorically)</a></li></ol></li><li class='history-month'><label for='2017-5'>May</label><input type='checkbox'  id='2017-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-4'>IdentityServer3 with PKCE Part 4 - Persisting User Data</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-3'>IdentityServer3 with PKCE Part 3 - Persist IdentityServer Configuration</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-2'>IdentityServer3 with PKCE Part 2 - Protected Resource Server</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/identityserver3-with-pkce-part-1-simple'>IdentityServer3 with PKCE Part 1 - Simple OAuth2 Server</a></li></ol></li><li class='history-month'><label for='2017-3'>March</label><input type='checkbox'  id='2017-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 5c - Multiple Solutions: Dependencies</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/sane-database-schema-conventions'>Sane Database Schema Conventions</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-agent'>TFS Continuous Integration - Agent Installation and Visual Studio Licensing</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-clickonce'>TFS Continuous Integration - ClickOnce Apps</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-and-private'>TFS Continuous Integration and Private NuGet Package Sources</a></li></ol></li><li class='history-month'><label for='2017-2'>February</label><input type='checkbox'  id='2017-2' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_22'>TFS Continuous Integration Walk Through Part 5b - Multiple Solutions: Simple Project References</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_20'>TFS Continuous Integration Walk Through Part 5a - Multiple Solutions: Overview</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_24'>TFS Continuous Integration Walk Through Part 4b - Problems With Traits</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_6'>TFS Continuous Integration Walk Through Part 4a - Filtering Tests</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_63'>TFS Continuous Integration Walk Through Part 3 - Notifications</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through_5'>TFS Continuous Integration Walk Through Part 2 - Create an Automated Build</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/tfs-continuous-integration-walk-through'>TFS Continuous Integration Walk Through Part 1 - Installing TFS and Checking In a Test Project</a></li></ol></li><li class='history-month'><label for='2017-1'>January</label><input type='checkbox'  id='2017-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/what-else-programmers-do-text'>What Else Programmers Do: A Text Manipulation Example</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/what-does-this-code-do-extended'>What does this code do? Extended explanation</a></li></ol></li></ol></li><li class='history-year'><label for='2016'>2016</label><input type='checkbox'  id='2016' /><ol><li class='history-month'><label for='2016-12'>December</label><input type='checkbox'  id='2016-12' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/nexus-5-gps-lock-problem-and-two'>Nexus 5 GPS Lock Problem and Three--or More!--Solutions</a></li></ol></li><li class='history-month'><label for='2016-11'>November</label><input type='checkbox'  id='2016-11' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-bypass-new-microsoft-office'>How to Bypass the New Microsoft Office Startup and Save Screens</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/google-tasks-vs-reminders-in-desktop'>Google Tasks vs Reminders in Desktop and Phone</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-claims-based-identity-part-1_6'>Catching Up on Coding - Claims-Based Identity Part 1</a></li></ol></li><li class='history-month'><label for='2016-10'>October</label><input type='checkbox'  id='2016-10' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/creating-forms-authentication'>Creating Forms Authentication Membership Tables in LocalDB–Right and Wrong Ways</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-10-complaint-1-auto-update'>Windows 10 Complaint #1: Auto Update State Loss</a></li></ol></li><li class='history-month'><label for='2016-9'>September</label><input type='checkbox'  id='2016-9' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/disable-windows-10-photo-automatic'>Disable Windows 10 Photo Automatic Albums</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/a-laymans-explanation-of-mocking-and'>A Layman’s Explanation of Mocking and Dependency Injection</a></li></ol></li><li class='history-month'><label for='2016-8'>August</label><input type='checkbox'  id='2016-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-3'>Catching Up on Coding - TDD Part 3</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-2'>Catching Up on Coding - TDD Part 2</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-tdd-part-1'>Catching Up on Coding - TDD Part 1</a></li></ol></li><li class='history-month'><label for='2016-7'>July</label><input type='checkbox'  id='2016-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/writing-to-current-users-registry-when'>Writing to the Current User(s) Registry When Running as System</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/catching-up-on-coding-syllabus'>Catching Up on Coding - The Syllabus</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/quickly-enable-mercurial-keyring-for'>Quickly Enable Mercurial Keyring for BitBucket</a></li></ol></li><li class='history-month'><label for='2016-6'>June</label><input type='checkbox'  id='2016-6' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/create-easily-debuggable-windows-service'>Create an Easily Debuggable Windows Service</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/underrated-work-skills'>(Underrated) Work Skills</a></li></ol></li><li class='history-month'><label for='2016-5'>May</label><input type='checkbox'  id='2016-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/vbnet-windows-project-to-c-conversion'>VB.Net Windows Project to C# Conversion Tools Quick Review</a></li></ol></li><li class='history-month'><label for='2016-2'>February</label><input type='checkbox'  id='2016-2' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/scroll-bars-in-blogger-tags'>Scroll bars in Blogger &lt;pre&gt; Tags</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/google-keep-changes-taking-to-forums'>Google Keep Changes: Taking to the Forums</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/backward-step-for-google-keep'>Backward Step for Google Keep</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/recover-virtualbox-snapshots'>Recover VirtualBox Snapshots</a></li></ol></li><li class='history-month'><label for='2016-1'>January</label><input type='checkbox'  id='2016-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/auto-updating-new-windows-7-installation'>Auto Updating a New Windows 7 Installation</a></li></ol></li></ol></li><li class='history-year'><label for='2015'>2015</label><input type='checkbox'  id='2015' /><ol><li class='history-month'><label for='2015-8'>August</label><input type='checkbox'  id='2015-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/shoretel-brilliantly-simple'>ShoreTel - Brilliantly Simple?</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/the-google-photos-management-problems'>The Google Photos Management Problem(s)</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/creating-long-lasting-clickonce'>Creating a Long-Lasting ClickOnce Certificate</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/more-encrypted-config-filesclickonce'>More Encrypted Config Files–ClickOnce Complications</a></li></ol></li><li class='history-month'><label for='2015-7'>July</label><input type='checkbox'  id='2015-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/encrypting-appconfig'>Encrypting app.config</a></li></ol></li><li class='history-month'><label for='2015-3'>March</label><input type='checkbox'  id='2015-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/better-google-sites-designthe-notched'>Better Google Sites Design–The Notched Page</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/removing-unremovable-bluetooth-device'>Removing Unremovable Bluetooth Device: FAIL!</a></li></ol></li></ol></li><li class='history-year'><label for='2014'>2014</label><input type='checkbox'  id='2014' /><ol><li class='history-month'><label for='2014-11'>November</label><input type='checkbox'  id='2014-11' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-remove-savernet-and-similar'>How to remove Savernet (and similar) Chrome extension</a></li></ol></li><li class='history-month'><label for='2014-9'>September</label><input type='checkbox'  id='2014-9' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/prevent-word-from-restoring-minimized'>Prevent Word from Restoring Minimized Documents</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/clever-phish'>Clever Phish</a></li></ol></li><li class='history-month'><label for='2014-8'>August</label><input type='checkbox'  id='2014-8' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/enable-synaptics-touchpad-2-finger-tap'>Enable Synaptics touchpad 2-finger tap context menu</a></li></ol></li><li class='history-month'><label for='2014-5'>May</label><input type='checkbox'  id='2014-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/installing-fcm-flow-cytrometry-library'>Installing fcm flow cytrometry library on Windows 8.1</a></li></ol></li><li class='history-month'><label for='2014-4'>April</label><input type='checkbox'  id='2014-4' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-update-1-driver-problem-dtmb'>Windows 8.1 Update 1 Driver Problem DTMB BDA TV USB</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-window-key-s-search-from'>Windows 8.1: Window Key + S = Search from Desktop</a></li></ol></li><li class='history-month'><label for='2014-3'>March</label><input type='checkbox'  id='2014-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/whs-2011-windows-update-one-or-more'>WHS 2011 Windows Update “One or more services are no running” alert</a></li></ol></li><li class='history-month'><label for='2014-2'>February</label><input type='checkbox'  id='2014-2' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/lenovo-u530-touch-wifi-problem-continued'>Lenovo U530 Touch WiFi Problem Continued</a></li></ol></li><li class='history-month'><label for='2014-1'>January</label><input type='checkbox'  id='2014-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/lenovo-u530-touch-wifi-problem'>Lenovo U530 Touch WiFi Problem</a></li></ol></li></ol></li><li class='history-year'><label for='2013'>2013</label><input type='checkbox'  id='2013' /><ol><li class='history-month'><label for='2013-12'>December</label><input type='checkbox'  id='2013-12' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/whs-connector-restart-error-in-windows'>WHS Connector Restart Error in Windows 8.0/8.1</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/how-to-remove-apps-from-google-play-my'>How to Remove Apps from Google Play My Apps Site</a></li></ol></li><li class='history-month'><label for='2013-11'>November</label><input type='checkbox'  id='2013-11' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/windows-81-hidden-opt-ins-opt-outs'>Windows 8.1 Hidden Opt Ins/ Opt Outs</a></li></ol></li><li class='history-month'><label for='2013-9'>September</label><input type='checkbox'  id='2013-9' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-epilogue'>Edward Farley and the Fantastic Library Epilogue</a></li></ol></li><li class='history-month'><label for='2013-7'>July</label><input type='checkbox'  id='2013-7' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/a-week-or-more-of-jolicloud-day-2-end'>A Week (or More!) of JoliCloud - Day 2: THE END</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/a-week-or-more-of-jolicloud-day-1'>A Week (or More!) of JoliCloud - Day 1</a></li></ol></li><li class='history-month'><label for='2013-5'>May</label><input type='checkbox'  id='2013-5' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-12'>Edward Farley and the Fantastic Library Part 12</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-1019'>Edward Farley and the Fantastic Library Part 11</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-10'>Edward Farley and the Fantastic Library Part 10</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-9'>Edward Farley and the Fantastic Library Part 9</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-8'>Edward Farley and the Fantastic Library Part 8</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-4'>Edward Farley and the Fantastic Library Part 4</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-3'>Edward Farley and the Fantastic Library Part 3</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-2'>Edward Farley and the Fantastic Library Part 2</a></li><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-1'>Edward Farley and the Fantastic Library Part 1</a></li></ol></li><li class='history-month'><label for='2013-4'>April</label><input type='checkbox'  id='2013-4' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/clean-up-orphaned-sql-users'>Clean Up Orphaned SQL Users</a></li></ol></li><li class='history-month'><label for='2013-3'>March</label><input type='checkbox'  id='2013-3' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/t-sql-one-to-one-cant-be-done'>T-SQL One to One Can't Be Done</a></li></ol></li><li class='history-month'><label for='2013-1'>January</label><input type='checkbox'  id='2013-1' /><ol><li class='history-post'><a class='history-post' href='http://bladewolf55.gitlab.io/smblog/posts/test-post-with-code'>Migrating Google Drive</a></li></ol></li></ol></li></ol>
    </div>
  </nav>
  <header>
    <div id="site-image">
      <img src="http://bladewolf55.gitlab.io/smblog/images/header.png" alt="" />
    </div>
    <h1 id="site-name"></h1>
    <div id="site-subtitle">A pleasant walk through computing</div>
  </header>
  <section id="content">
    <h1 id="home">Home</h1>

  </section>
  <!-- posts only appear in home index -->
  <section id="posts">
    
              <div class='post'>
                <h2 class='post-title'><a href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-7'>Edward Farley and the Fantastic Library Part 7</a></h2>
                <p class='post-info'><span class='posted-on'>2013-05-19 12:42</span></p>
                <div class='post-content'><p>Parts</p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1.html">1) Preface</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-2.html">2) Introduction</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-3.html">3) A Simple Table</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-4.html">4) One to One or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-5.html">5) Zero or One to Zero or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-6.html">6) One to Zero or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-7.html">7) One to Zero or One</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-8.html">8) One to One</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-9.html">9) Many to Many, Simple</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-10.html">10) Many to Many with Payload</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1019.html">11) Enumerables</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-12.html">12) Inheritance</a></p>
<p><a href="https://drive.google.com/folderview?id=0B9XcO7NbiPZcc29IZDVIN2kzZDQ&amp;usp=sharing">Source Code</a></p>
<h2 id="entity-framework-5-code-first-relationships">Entity Framework 5 Code First Relationships</h2>
<h3 id="one-to-zero-or-one">One to Zero or One</h3>
<p><em>In which the Professor demonstrates that travel is educational.</em></p>
<p>Edward had sprinted from the bicycle lot, walked quickly (but did not run) in the library’s main floor, then took the stairs two at a time and jogged to his reading room where Professor Relvar was waiting. Edward was exactly thirty-seven seconds early.</p>
<p>“My dear boy, you look exhausted.” The Professor smiled slightly and adjusted his reading glasses. “Isn’t your bicycle in good repair?”</p>
<p>“Sure it is, Professor,” said Edward, huffing between words. “My dad helps me with it. Mom, too.”</p>
<p>“To be sure. Your mother was always mechanically inclined. Well, I’m glad to hear your conveyance is functionally sound. We sojourn now to the bicycle lot, and from there to Sunderland Library.”</p>
<p>Edward’s eyes widened, imagining even more bicycling, but he didn’t say anything. In the lot, they retrieved their bicycles and started off. The Professor rode a classic Kermit. Edward pedaled a bright red Herman. As they rode, the Professor lectured....</p>
<p>Not everyone owns a Bicycle, [he said]. Many people enjoy walking to the library. I myself walked for years, until I spied a picture of this lovely two-wheeler on display at a Henson shop garage sale. (I did not buy the garage, however.) Bicycles are manufactured to order, so each person’s is unique. Choosing a bicycle is, as you know, a delicate thing. For various historical, practical and aesthetic reasons, a person doesn’t have to have a bicycle, but once built it’s his or hers for life. Bicycle makers are proud of their ability to maintain and modify a bicycle for decades.</p>
<p>A person doesn’t have to a have a bicycle, but a bicycle must have an owner. We have a One to Zero or One relationship, and it is a bit peculiar.</p>
<p>[Edward had been frowning, and raised his hand. He could ride pretty well one-handed. “Yes?” asked the Professor. Edward said, “Why wouldn’t you just add properties to the Person class--you know, table columns--like HasBicycle and BicycleModel?”]</p>
<p>Ah, excellent! I was beginning to think your parents had misinformed me about your aptitude.</p>
<p>The answer is, you could. But what if, later, you wanted to know more about this bicycle? You might end up with twenty properties. Would it make sense to have those all in the Persons table when a person might not even own a bicycle? No.*</p>
<p>I will describe the way I solve this problem, and you will have to imagine the code.** First, the schema.</p>
<p><strong>LearningEFSchema.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> Person: IValidatableObject
{
<span class="co">//Primary Key</span>
<span class="kw">public</span> <span class="dt">int</span> PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }
[Required]
<span class="kw">public</span> <span class="dt">string</span> Name { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;LibraryCard&gt; LibraryCards { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> <span class="kw">virtual</span> ICollection Pencils&lt;Pencil&gt; { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> <span class="kw">virtual</span> ICollection Magnifiers&lt;Magnifier&gt; { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> <span class="kw">virtual</span> Bicycle Bicycle { <span class="kw">get</span>; <span class="kw">set</span>; }
....

<span class="kw">public</span> <span class="kw">class</span> Bicycle
{
<span class="co">//Primary Key same as Person</span>
[Key, <span class="fu">ForeignKey</span>(<span class="st">&quot;Person&quot;</span>)]
<span class="kw">public</span> <span class="dt">int</span> PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }
[Required]
<span class="kw">public</span> <span class="dt">string</span> Model { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> Person Person { <span class="kw">get</span>; <span class="kw">set</span>; }
}</code></pre></div>
<p>The important items are that the Person class references just one Bicycle that is not required, and Bicycle references just one Person where the PersonId property is both the primary key and the foreign key. In essence, we are extending the Person table.</p>
<p>The Context class gets the expected DbSet.</p>
<p><strong>LearningEFDb.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> LearningEFDb: DbContext
{
<span class="kw">public</span> DbSet&lt;Bicycle&gt; Bicycles { <span class="kw">get</span>; <span class="kw">set</span>; }</code></pre></div>
<p>We add to our program.</p>
<p><strong>Program.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Add Bicycle without a Person&quot;</span>);
Bicycle bicycle = <span class="kw">new</span> <span class="fu">Bicycle</span>() { Model = <span class="st">&quot;Herman&quot;</span> };
_db.<span class="fu">Bicycles</span>.<span class="fu">Add</span>(bicycle);
<span class="fu">SaveChanges</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Set the Person, save, retrieve and show&quot;</span>);
bicycle.<span class="fu">Person</span> = edward;
<span class="fu">SaveChanges</span>();
bicycle = _db.<span class="fu">Bicycles</span>.<span class="fu">First</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Model: &quot;</span> + bicycle.<span class="fu">Model</span> + <span class="st">&quot;, Person: &quot;</span> + bicycle.<span class="fu">Person</span>.<span class="fu">Name</span>);</code></pre></div>
<p>And run it.</p>
<pre class="console"><code>Create Person without a name.
Saving changes.
ERROR: The Name field is required.
Add the required name and Library Card and save.
Saving changes.
Successful save.
Get the record we just saved, and display.
Person: Edward Farley has card: 123
Create and save Magnifier with required serial number
Saving changes.
Successful save.
Retrieve Magnifier, show it doesn&#39;t belong to someone.
Magnifier: Bar123, Person: available
Edward gets the Magnifier. Save and retrieve.
Saving changes.
Successful save.
Magnifier: Bar123, Person: Edward Farley
Try to add duplicate magnifier
Saving changes.
ERROR: Magnifier with this serial nbr already exists.
Add/save Pencil setting Nickname to null.
Saving changes.
ERROR: The Nickname field is required.
Set Nickname to empty string and save
Saving changes.
Successful save.
Retrieve pencil, change Nickname, save
Pencil: , Person: Edward Farley
Saving changes.
Successful save.
Pencil: Blackwing, Person: Edward Farley
Add Bicycle without a Person
Saving changes.
ERROR: The INSERT statement conflicted with the FOREIGN KEY constraint &quot;FK_dbo.Bicycles_dbo.Persons_PersonId&quot;. The conflict occurred in database &quot;EFDb&quot;, table &quot;dbo.Persons&quot;, column &#39;PersonId&#39;.
The statement has been terminated.
Set the Person, save, retrieve and show
Saving changes.
Successful save.
Model: Herman, Person: Edward Farley
Finished</code></pre>
<p>It is not a lovely error, but suits our educational purpose. The resulting table would be scripted so:</p>
<p><strong>T-SQL</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">create table <span class="fu">Bicycles</span> (
PersonId not <span class="kw">null</span> primary key foreign key references <span class="fu">Persons</span>(PersonId),
Model <span class="fu">nvarchar</span>(max) not <span class="kw">null</span>
)</code></pre></div>
<p>With that, Edward and Professor Relvar had arrived at Sunderland Library which, as anyone knows, maintains the finest collection of ice cream recipe books found anywhere. Plus, chefs who prepare scoops for anyone who cares to taste.</p>
<p>“And if it weren’t for the bicycles,” the Professor stated, licking happily at his Chocolate Peanut Butter and Pretzel Sundae, “all Sunderland regulars would be fat. Another scoop, Edward?”</p>
<hr />
<p>*Though some would say, “Yes.” The question is when to use table-per-type, table-per-hierarchy, or table-per-concrete-type, which will come up again in Inheritance. Also, the Professor might be thinking ahead too much. Some Agile development methods would say to do the simplest thing first (TPH), then change to TPT if needed. The fact is, the author doesn’t like TPH and discriminator columns.</p>
<p>**Which, fortunately, we don’t have to wait for.</p>
<p><a href="http://www.imdb.com/title/tt0079588/?ref_=fn_al_tt_1">The Muppet Movie</a></p>
<p><a href="http://www.imdb.com/title/tt0089791/?ref_=sr_1">Pee-wee’s Big Adventure</a></p>
<p><a href="http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx">EF Inheritance Models</a></p>
<p><a href="http://www.amazon.com/The-Perfect-Scoop-Granitas-Accompaniments/dp/158008219X/ref=sr_1_1?ie=UTF8&amp;qid=1367882906&amp;sr=8-1&amp;keywords=ice+cream+recipes">The Perfect Scoop</a></p>
<hr />
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-6'>Edward Farley and the Fantastic Library Part 6</a></h2>
                <p class='post-info'><span class='posted-on'>2013-05-19 12:40</span></p>
                <div class='post-content'><p>Parts</p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1.html">1) Preface</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-2.html">2) Introduction</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-3.html">3) A Simple Table</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-4.html">4) One to One or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-5.html">5) Zero or One to Zero or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-6.html">6) One to Zero or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-7.html">7) One to Zero or One</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-8.html">8) One to One</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-9.html">9) Many to Many, Simple</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-10.html">10) Many to Many with Payload</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1019.html">11) Enumerables</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-12.html">12) Inheritance</a></p>
<p><a href="https://drive.google.com/folderview?id=0B9XcO7NbiPZcc29IZDVIN2kzZDQ&amp;usp=sharing">Source Code</a></p>
<h2 id="entity-framework-5-code-first-relationships">Entity Framework 5 Code First Relationships</h2>
<h3 id="one-to-zero-or-many">One to Zero or Many</h3>
<p><em>Our hero see his pencils in a new light.</em></p>
<p>“Take me to your reading room,” commanded the Professor. “We shall eat en route.”</p>
<p>Edward’s room was modest. He was too young to have acquired many items, but he hoped someday to study something so interesting that he’d have to build an addition. For now, he just had a desk, some chairs and a couch. Plus, his framed mosaic of his favorite authors.</p>
<p>“Yes, yes. Quite nice, though it lacks some fire. We’ll see if we can’t kindle you, eh?”</p>
<p>The Professor laughed to himself. Apparently this was a joke only he understood. He suddenly stepped to the desk.</p>
<p>“See? Here?”</p>
<p>Edward timidly shook his head.</p>
<p>“Your pencils, my boy. How many?”</p>
<p>“Three. Sir.”</p>
<p>Professor Relvar picked them up, scrutinizing. “Good quality wood. Decent whittling. Proud of your work?”</p>
<p>“Yes, I guess so. I’ve seen nicer. My dad’s are fantastic!”</p>
<p>“Just so! Just so! We can appreciate our work while being modest. Have you considered this remarkable object? We value them highly, teaching everyone how to whittle and assemble their own pencils. Works of art, some people’s. Ms. Turner turns out terrific ones--or so she tongue-twistingly intones. Would you buy a pre-made pencil? Of course not! You dream of making your own. We’re all the same in this way. The pencil is today’s subject.”</p>
<p>Everyone, [he continued, sitting behind the desk], can have a Pencil. Not everyone does, and, while I personally don’t understand them, many people have done great work without a pencil. So, a person can whittle and own zero or more pencils. But a pencil always belongs to just one person. This is called a One to Zero or Many relationship, and it is very common. In fact, it may be the most common relationship.</p>
<p>Here is how we’ll model it:</p>
<p><strong>LearingEFSchema.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> Person...
...
<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;LibraryCard&gt; LibraryCards { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;Magnifier&gt; Magnifiers { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;Pencil&gt; Pencils { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="kw">public</span> <span class="fu">Person</span>()
{
LibraryCards = <span class="kw">new</span> HashSet&lt;LibraryCard&gt;();
Magnifiers = <span class="kw">new</span> HashSet&lt;Magnifier&gt;();
Pencils = <span class="kw">new</span> HashSet&lt;Pencil&gt;();
}

<span class="kw">public</span> <span class="kw">class</span> Pencil
{
<span class="co">//Primary Key</span>
<span class="kw">public</span> <span class="dt">int</span> PencilId { <span class="kw">get</span>; <span class="kw">set</span>; }
[<span class="fu">Required</span>(AllowEmptyStrings = <span class="kw">true</span>)]
<span class="kw">public</span> <span class="dt">string</span> Nickname { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="co">//Foreign Key column</span>
<span class="kw">public</span> <span class="dt">int</span> PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> Person Person { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="kw">public</span> <span class="fu">Pencil</span>()
{
Nickname = <span class="st">&quot;&quot;</span>;
}
}</code></pre></div>
<p><strong>LearningEFDb.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> LearningEFDb: DbContext
{
<span class="kw">public</span> DbSet&lt;LibraryCard&gt; LibraryCards { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> DbSet&lt;Magnifier&gt; Magnifiers { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> DbSet&lt;Pencil&gt; Pencils { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> DbSet&lt;Person&gt; Persons { <span class="kw">get</span>; <span class="kw">set</span>; }</code></pre></div>
<p>We introduce one new wrinkle, today. We’re requiring a Nickname, and yet we’re not! We allow an empty string. Why, you may ask?</p>
<p>[The Professor waited patiently until Edward sheepishly asked, “Why, Professor?”]</p>
<p>I’m so glad you asked. Many fields should not allow nulls. Names are a good example. Let’s say we stored first, middle and last names in nullable table columns. To concatenate them and display the full name, we would have to convert nulls to empty strings, otherwise the full name would become null. I’m sure there’s something philosophical to say about how objects added to a void becoming the void, but that isn’t my field.</p>
<p>Let’s add to our program and try to set a pencil’s nickname to null.</p>
<p><strong>Program.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Add/save Pencil setting Nickname to null.&quot;</span>);
Pencil pencil = <span class="kw">new</span> <span class="fu">Pencil</span>() { Nickname = <span class="kw">null</span>, Person = edward };
_db.<span class="fu">Pencils</span>.<span class="fu">Add</span>(pencil);
<span class="fu">SaveChanges</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Set Nickname to empty string and save&quot;</span>);
pencil.<span class="fu">Nickname</span> = <span class="st">&quot;&quot;</span>;
<span class="fu">SaveChanges</span>();

Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Retrieve pencil, change Nickname, save&quot;</span>);
pencil = _db.<span class="fu">Pencils</span>.<span class="fu">First</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Pencil: &quot;</span> + pencil.<span class="fu">Nickname</span> + <span class="st">&quot;, Person: &quot;</span> + pencil.<span class="fu">Person</span>.<span class="fu">Name</span>);
pencil.<span class="fu">Nickname</span> = <span class="st">&quot;Blue&quot;</span>;
<span class="fu">SaveChanges</span>();
pencil = _db.<span class="fu">Pencils</span>.<span class="fu">First</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Pencil: &quot;</span> + pencil.<span class="fu">Nickname</span> + <span class="st">&quot;, Person: &quot;</span> + pencil.<span class="fu">Person</span>.<span class="fu">Name</span>);</code></pre></div>
<p>Running the program now produces a Pencils table like so:</p>
<p><strong>T-SQL</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">create table <span class="fu">Pencils</span> (
PencilId <span class="dt">int</span> not <span class="kw">null</span> identity primary key,
Nickname <span class="fu">nvarchar</span>(max) not <span class="kw">null</span>,
PersonId <span class="dt">int</span> not <span class="kw">null</span> foreign key references <span class="fu">Persons</span>(PersonId)
)</code></pre></div>
<p>And produces the following output:</p>
<pre class="console"><code>Create Person without a name.
Saving changes.
ERROR: The Name field is required.
Add the required name and Library Card and save.
Saving changes.
Successful save.
Get the record we just saved, and display.
Person: Edward Farley has card: 123
Create and save Magnifier with required serial number
Saving changes.
Successful save.
Retrieve Magnifier, show it doesn&#39;t belong to someone.
Magnifier: Bar123, Person: available
Edward gets the Magnifier. Save and retrieve.
Saving changes.
Successful save.
Magnifier: Bar123, Person: Edward Farley
Try to add duplicate magnifier
Saving changes.
ERROR: Magnifier with this serial nbr already exists.
Add/save Pencil setting Nickname to null.
Saving changes.
ERROR: The Nickname field is required.
Set Nickname to empty string and save
Saving changes.
Successful save.
Retrieve pencil, change Nickname, save
Pencil: , Person: Edward Farley
Saving changes.
Successful save.
Pencil: Blackwing, Person: Edward Farley
Finished</code></pre>
<p>Tomorrow, Edward, we’ll meet here. Do not keep me waiting! That’s simply bad manners. Now, what are you grinning at?</p>
<hr />
<p><a href="http://en.wikipedia.org/wiki/Shunyata">Sunyata (Void-ness)</a></p>
<p><a href="http://en.wikipedia.org/wiki/VoiD">Vocabulary of Interlinked Datasets</a></p>
<p><a href="http://www.pencils.com/all-brands/blackwing">Blackwing Pencil</a></p>
<hr />
</div>
              </div>
              

              <div class='post'>
                <h2 class='post-title'><a href='http://bladewolf55.gitlab.io/smblog/posts/edward-farley-part-5'>Edward Farley and the Fantastic Library Part 5</a></h2>
                <p class='post-info'><span class='posted-on'>2013-05-19 12:38</span></p>
                <div class='post-content'><p>Parts</p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1.html">1) Preface</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-2.html">2) Introduction</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-3.html">3) A Simple Table</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-4.html">4) One to One or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-5.html">5) Zero or One to Zero or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-6.html">6) One to Zero or Many</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-7.html">7) One to Zero or One</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-8.html">8) One to One</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-9.html">9) Many to Many, Simple</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-10.html">10) Many to Many with Payload</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-1019.html">11) Enumerables</a></p>
<p><a href="http://www.softwaremeadows.com/2013/05/edward-farley-part-12.html">12) Inheritance</a></p>
<p><a href="https://drive.google.com/folderview?id=0B9XcO7NbiPZcc29IZDVIN2kzZDQ&amp;usp=sharing">Source Code</a></p>
<h2 id="entity-framework-5-code-first-relationships">Entity Framework 5 Code First Relationships</h2>
<h3 id="zero-or-one-to-zero-or-many">Zero or One to Zero or Many</h3>
<p><em>The Professor produces his favorite Magnifier.</em></p>
<p>“Hi, Professor,” said Edward Farley. “Mom added raisins to your sandwich.”</p>
<p>The Professor accepted the sandwich with a delighted smile, then scowled and said, “Today, young man, I will lavish great salivary care on this culinary delicacy before accepting interrogatives.”</p>
<p>“Huh?” said Edward.</p>
<p>“I’m not answering any questions until I’ve eaten.”</p>
<p>“Oh.”</p>
<p>They ate in silence, the older man clearly enjoying himself and the torture he was inflicting on his impatient student. Finally, the last crumb tasted, they set to work and the Professor began to lecture.</p>
<p>Observe, Edward, [he began]. I hold in my hand a prized possession. My first magnifying glass. It’s an unfortunate truth of age that our eyes fail. Also, there are several rather fine books with print so small that one needs a good magnifier to read them. (The print was small to conserve paper, before we learned to make artificial paper. I applaud the reduced resources, but I do miss the aroma of those old tomes.)</p>
<p>Magnifiers are hand-crafted in Birmuthe. Lovely work. A person blessed with excellent vision doesn’t have to own one. A magnifier might not ever be used, but if it is it belongs to that person for life.</p>
<p>This is a Zero or One to Zero or Many relationship. A magnifier doesn’t require a person, and a person can have zero or more magnifiers. Here is how the relationship is modeled.</p>
<p><strong>LearningEFSchema.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> Person : IValidatableObject
{
<span class="co">//Primary Key</span>
<span class="kw">public</span> <span class="dt">int</span> PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }
[Required]
<span class="kw">public</span> <span class="dt">string</span> Name { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;LibraryCard&gt; LibraryCards { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> <span class="kw">virtual</span> ICollection&lt;Magnifier&gt; Magnifiers { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="kw">public</span> <span class="fu">Person</span>()
{
LibraryCards = <span class="kw">new</span> HashSet&lt;LibraryCard&gt;();
Magnifiers = <span class="kw">new</span> HashSet&lt;Magnifier&gt;();
}

<span class="kw">public</span> <span class="kw">class</span> Magnifier
{
<span class="co">//Primary Key</span>
<span class="kw">public</span> <span class="dt">int</span> MagnifierId { <span class="kw">get</span>; <span class="kw">set</span>; }
[Required]
<span class="kw">public</span> <span class="dt">string</span> SerialNbr { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="co">//Foreign Key column</span>
<span class="kw">public</span> <span class="dt">int</span>? PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> Person Person { <span class="kw">get</span>; <span class="kw">set</span>; }
}</code></pre></div>
<p><strong>LearningEFDb.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> LearningEFDb: DbContext
{
<span class="kw">public</span> DbSet&lt;LibraryCard&gt; LibraryCards { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> DbSet&lt;Magnifier&gt; Magnifiers { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="kw">public</span> DbSet&lt;Person&gt; Persons { <span class="kw">get</span>; <span class="kw">set</span>; }</code></pre></div>
<p>You have already observed that this is almost identical to our Library Card. The differences are:</p>
<p>A person doesn’t have to have a magnifier, so there is no validation for that.</p>
<p>A magnifier doesn’t require a person, so the PersonId foreign key property is nullable.</p>
<p>If we run our program, the following table gets created.</p>
<p><strong>T-SQL</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">create table <span class="fu">Magnifiers</span> (
MagnifierId <span class="dt">int</span> not <span class="kw">null</span> identity primary key,
SerialNbr <span class="fu">nvarchar</span>(max) not <span class="kw">null</span> unique nonclustered,
PersonId <span class="dt">int</span> <span class="kw">null</span> foreign key references <span class="fu">Persons</span>(PersonId)
)</code></pre></div>
<p>And, we’re finished, right? Wrong! We have a problem. In fact, we have a problem that exists in Library Cards, too, and that I was waiting for you to cry havoc about and let slip the dogs of code. Pardon me? Really, my boy, you should read more Shakespeare.</p>
<p>The problem in Library Cards is with their Number, and in Magnifiers with their SerialNbr. Do you suppose two cards or magnifiers can have the same number? I should say not. Mr. Barrows at Birmuthe is very careful on that point. Each magnifier is given a unique serial number.</p>
<p>We already have a primary key (MagnifierId) on our Magnifier table, which uniquely identifies a row. The SerialNbr column is called by some a candidate key. It could be the primary key, but isn’t. Why don’t I just use it as my primary key? Because I don’t like to. It’s really that simple. Oh, I could go on and on about how consistency is glorious, and how Mr. Barrows might decide to recall all his magnifiers and change their serial numbers (or a library could change its card numbering scheme), and those are, indeed, good reasons. But they can be worked around.</p>
<p>The fact is, I like having a consistent primary key in both name and type*.</p>
<p>So, our serial number must be unique. How do we tell the Framework about that? Sadly, we don’t. At least, not directly. Remember, a class doesn’t know about the Framework, so it can’t check itself for uniqueness. There are no doubt other (possibly more clever) solutions than the one I’m about to show. Perhaps you, Edward, will improve on my work, eh?</p>
<p>We turn to our IValidatable interface, and add code that, in effect, tells the class “If you receive any errors from the context, return them as validation errors.” We are coupling the class to a context, but notice that a ValidationContext does not have to be a Framework context. In our case, of course, it will be the DBContext.</p>
<p><strong>LearningEFSchema.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="kw">class</span> Magnifier : IValidatableObject
{
<span class="co">//Primary Key</span>
<span class="kw">public</span> <span class="dt">int</span> MagnifierId { <span class="kw">get</span>; <span class="kw">set</span>; }
[Required]
<span class="kw">public</span> <span class="dt">string</span> SerialNbr { <span class="kw">get</span>; <span class="kw">set</span>; }
<span class="co">//Foreign Key column</span>
<span class="kw">public</span> <span class="dt">int</span>? PersonId { <span class="kw">get</span>; <span class="kw">set</span>; }

<span class="co">//Navigation</span>
<span class="kw">public</span> <span class="kw">virtual</span> Person Person { <span class="kw">get</span>; <span class="kw">set</span>; }

IEnumerable IValidatableObject.<span class="fu">Validate</span>(ValidationContext validationContext)
{
<span class="co">//Check for any Items in context. If they&#39;re ValidationResults, yield them.</span>
<span class="kw">if</span> (validationContext.<span class="fu">Items</span> != <span class="kw">null</span>)
{
<span class="kw">foreach</span> (var item <span class="kw">in</span> validationContext.<span class="fu">Items</span>)
{
<span class="kw">if</span> (item.<span class="fu">Value</span> <span class="kw">is</span> ValidationResult)
{
<span class="kw">yield</span> <span class="kw">return</span> (ValidationResult)item.<span class="fu">Value</span>;
}
}
}
}
}</code></pre></div>
<p>In our Context, we add a using statement:</p>
<p><strong>LearningEFDb.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">using</span> System.<span class="fu">ComponentModel</span>.<span class="fu">DataAnnotations</span>;</code></pre></div>
<p>We add a method to check for duplicate SerialNbrs.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">public</span> <span class="dt">bool</span> <span class="fu">IsUniqueMagnifierSerialNbr</span>(Magnifier magnifier)
{
<span class="dt">var</span> entity = <span class="kw">this</span>.<span class="fu">Magnifiers</span>.<span class="fu">SingleOrDefault</span>(a =&gt; a.<span class="fu">MagnifierId</span> != magnifier.<span class="fu">MagnifierId</span> &amp; a.<span class="fu">SerialNbr</span> == magnifier.<span class="fu">SerialNbr</span>);
<span class="kw">return</span> (entity == <span class="kw">null</span>);
}</code></pre></div>
<p>Finally, we override the ValidateEntity method, and add the following code.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs"><span class="kw">protected</span> <span class="kw">override</span> System.<span class="fu">Data</span>.<span class="fu">Entity</span>.<span class="fu">Validation</span>.<span class="fu">DbEntityValidationResult</span> <span class="fu">ValidateEntity</span>(System.<span class="fu">Data</span>.<span class="fu">Entity</span>.<span class="fu">Infrastructure</span>.<span class="fu">DbEntityEntry</span> entityEntry, IDictionary&lt;<span class="dt">object</span>, <span class="dt">object</span>&gt; items)
{
<span class="kw">if</span> (items == <span class="kw">null</span>) { items = <span class="kw">new</span> Dictionary&lt;<span class="dt">object</span>, <span class="dt">object</span>&gt;(); }
<span class="co">//Magnifier Serial Number</span>
<span class="kw">if</span> (entityEntry.<span class="fu">Entity</span> <span class="kw">is</span> Magnifier) { var entity = (Magnifier)entityEntry.<span class="fu">Entity</span>;
<span class="kw">if</span> (!<span class="fu">IsUniqueMagnifierSerialNbr</span>(entity))
{
items.<span class="fu">Add</span>(<span class="kw">new</span> <span class="fu">KeyValuePair</span>(Guid.<span class="fu">NewGuid</span>(), <span class="kw">new</span> <span class="fu">ValidationResult</span>(<span class="st">&quot;Magnifier with this serial nbr already exists.&quot;</span>, <span class="kw">new</span> List&lt;<span class="dt">string</span>&gt;() { <span class="st">&quot;SerialNbr&quot;</span> })));
}
}
<span class="kw">return</span> <span class="kw">base</span>.<span class="fu">ValidateEntity</span>(entityEntry, items);
}</code></pre></div>
<p>Do you see? The Framework validates for uniqueness when the entity, itself, is being validated, and tells the entity if there were errors. Unfortunately, the Framework is unable (some would say unwilling) to create the table with unique columns**. Let’s add to our program a rather lengthy test.</p>
<p><strong>Program.cs</strong></p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Create and save Magnifier with required serial number&quot;</span>);
Magnifier magnifier = <span class="kw">new</span> <span class="fu">Magnifier</span>() { SerialNbr = <span class="st">&quot;Bar123&quot;</span> };
_db.<span class="fu">Magnifiers</span>.<span class="fu">Add</span>(magnifier);
<span class="fu">SaveChanges</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Retrieve Magnifier, show it doesn&#39;t belong to someone.&quot;</span>);
magnifier = _db.<span class="fu">Magnifiers</span>.<span class="fu">First</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Magnifier: &quot;</span> + magnifier.<span class="fu">SerialNbr</span> + <span class="st">&quot;, Person: &quot;</span>
+ (magnifier.<span class="fu">Person</span> != <span class="kw">null</span> ? magnifier.<span class="fu">Person</span>.<span class="fu">Name</span> : <span class="st">&quot;available&quot;</span>));
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Edward gets the Magnifier. Save and retrieve.&quot;</span>);
magnifier.<span class="fu">Person</span> = edward;
<span class="fu">SaveChanges</span>();
magnifier = _db.<span class="fu">Magnifiers</span>.<span class="fu">First</span>();
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Magnifier: &quot;</span> + magnifier.<span class="fu">SerialNbr</span> + <span class="st">&quot;, Person: &quot;</span>
+ (magnifier.<span class="fu">Person</span> != <span class="kw">null</span> ? magnifier.<span class="fu">Person</span>.<span class="fu">Name</span> : <span class="st">&quot;available&quot;</span>));
Console.<span class="fu">WriteLine</span>(<span class="st">&quot;Try to add duplicate magnifier&quot;</span>);
magnifier = <span class="kw">new</span> <span class="fu">Magnifier</span>() { SerialNbr = <span class="st">&quot;Bar123&quot;</span> };
_db.<span class="fu">Magnifiers</span>.<span class="fu">Add</span>(magnifier);
<span class="fu">SaveChanges</span>();
<span class="co">//Clean up. Remove the magnifier;</span>
_db.<span class="fu">Magnifiers</span>.<span class="fu">Remove</span>(magnifier);</code></pre></div>
<p>Run the program. Ah, it works as expected! (If only this were more often the case, my boy.)</p>
<pre class="console"><code>Create Person without a name.
Saving changes.
ERROR: The Name field is required.
Add the required name and Library Card and save.
Saving changes.
Successful save.
Get the record we just saved, and display.
Person: Edward Farley has card: 123
Create and save Magnifier with required serial number
Saving changes.
Successful save.
Retrieve Magnifier, show it doesn&#39;t belong to someone.
Magnifier: Bar123, Person: available
Edward gets the Magnifier. Save and retrieve.
Saving changes.
Successful save.
Magnifier: Bar123, Person: Edward Farley
Try to add duplicate magnifier
Saving changes.
ERROR: Magnifier with this serial nbr already exists.
Finished</code></pre>
<p>That should give you enough to think about, young man. If, in fact, you do any thinking at all.</p>
<hr />
<p>*The Professor later wrote to Edward, saying there are practical exceptions to this. For instance, a Logins table might use GUIDs as primary keys to reduce security risks. A States table should use the state abbreviation as the key, and likewise a zip code table. These relationships are already established by the US Postal Service. **We could, however, add the unique constraint when the database is created by EF. Here’s the code that might run in a DbContext DatabaseInitializer.</p>
<div class="sourceCode"><pre class="sourceCode csharp"><code class="sourceCode cs">************* Unique Constraints ***************
db.<span class="fu">Database</span>.<span class="fu">ExecuteSqlCommand</span>(<span class="st">&quot;ALTER TABLE AppMachines ADD CONSTRAINT u_AppIdMachineId UNIQUE(AppId,MachineId)&quot;</span>);
************************************************</code></pre></div>
<p><a href="http://en.wikipedia.org/wiki/The_dogs_of_war_(phrase)">“Cry ‘Havoc!’ and let slip the dogs of war.”</a></p>
<hr />
</div>
              </div>
              
    <div class='paging'><a href='index23.html'>Newer</a>&nbsp;&nbsp;&nbsp;<a href='index25.html'>Older</a></div>
  </section>
  <footer><p>Copyright (c) 2018 Charles L Flatt</p>
</footer>
  
</body>

</html>